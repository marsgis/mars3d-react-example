/**
 * Mars3D平台插件,结合echarts可视化功能插件  mars3d-echarts
 *
 * 版本信息：v3.6.7
 * 编译日期：2023-09-25 10:02:19
 * 版权所有：Copyright by 火星科技  http://mars3d.cn
 * 使用单位：免费公开版 ，2023-03-17
 */
(function (global, factory) {
  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, (window.echarts || require('echarts')), (window.mars3d || require('mars3d'))) :
  typeof define === 'function' && define.amd ? define(['exports', 'echarts', 'mars3d'], factory) :
  (global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory(global["mars3d-echarts"] = {}, global.echarts, global.mars3d));
})(this, (function (exports, echarts, mars3d) { 
'use strict';const _0x37bc13=_0x2e84;(function(_0x1b74b3,_0x3f8f1c){const _0xaba44b={_0x2271cd:0x16d,_0x708701:0x176,_0x2824d2:0x167,_0x4af2e9:0x15d,_0x1f9db8:0x169},_0x2a6321=_0x2e84,_0x4e0624=_0x1b74b3();while(!![]){try{const _0x22d2a9=-parseInt(_0x2a6321(_0xaba44b._0x2271cd))/0x1*(-parseInt(_0x2a6321(0x18a))/0x2)+parseInt(_0x2a6321(0x18b))/0x3+parseInt(_0x2a6321(_0xaba44b._0x708701))/0x4+parseInt(_0x2a6321(0x188))/0x5+parseInt(_0x2a6321(_0xaba44b._0x2824d2))/0x6+parseInt(_0x2a6321(_0xaba44b._0x4af2e9))/0x7+-parseInt(_0x2a6321(_0xaba44b._0x1f9db8))/0x8;if(_0x22d2a9===_0x3f8f1c)break;else _0x4e0624['push'](_0x4e0624['shift']());}catch(_0x8ce1ba){_0x4e0624['push'](_0x4e0624['shift']());}}}(_0x3f05,0xc1d65));function _0x2e84(_0x40ca74,_0x5238d6){const _0x3f058f=_0x3f05();return _0x2e84=function(_0x2e84b3,_0x3611d9){_0x2e84b3=_0x2e84b3-0x158;let _0x4f10cb=_0x3f058f[_0x2e84b3];return _0x4f10cb;},_0x2e84(_0x40ca74,_0x5238d6);}function _interopNamespace(_0x3ac5fe){const _0x261de7={_0x4e66f5:0x17b,_0x3614d6:0x172},_0x1e2770={_0x8a1875:0x160},_0xd5804b=_0x2e84;if(_0x3ac5fe&&_0x3ac5fe[_0xd5804b(_0x261de7._0x4e66f5)])return _0x3ac5fe;var _0xfa6725=Object[_0xd5804b(_0x261de7._0x3614d6)](null);return _0x3ac5fe&&Object['keys'](_0x3ac5fe)['forEach'](function(_0x7da36d){const _0x2f5630=_0xd5804b;if(_0x7da36d!=='default'){var _0x293132=Object[_0x2f5630(0x16f)](_0x3ac5fe,_0x7da36d);Object[_0x2f5630(_0x1e2770._0x8a1875)](_0xfa6725,_0x7da36d,_0x293132[_0x2f5630(0x15f)]?_0x293132:{'enumerable':!![],'get':function(){return _0x3ac5fe[_0x7da36d];}});}}),_0xfa6725['default']=_0x3ac5fe,_0xfa6725;}var echarts__namespace=_interopNamespace(echarts),mars3d__namespace=_interopNamespace(mars3d);const Cesium$1=mars3d__namespace['Cesium'];class CompositeCoordinateSystem{constructor(_0x247c96,_0x3e9012){const _0x51db99={_0x4c74a8:0x17c},_0x49508d=_0x2e84;this['_mars3d_scene']=_0x247c96,this['dimensions']=[_0x49508d(0x165),_0x49508d(_0x51db99._0x4c74a8)],this['_mapOffset']=[0x0,0x0],this['_api']=_0x3e9012;}['setMapOffset'](_0x3c5778){const _0x8f5514={_0x550e84:0x186},_0x479500=_0x2e84;this[_0x479500(_0x8f5514._0x550e84)]=_0x3c5778;}['getBMap'](){return this['_mars3d_scene'];}['dataToPoint'](_0x2b1d87){const _0x378ec7={_0x7b4b42:0x15a},_0x1e26bf=_0x2e84,_0x16d890=this['_mars3d_scene'],_0x366ed4=[NaN,NaN];let _0x3a8c4f=_0x16d890['echartsFixedHeight'];_0x16d890['echartsAutoHeight']&&(_0x3a8c4f=_0x16d890['globe']['getHeight'](Cesium$1[_0x1e26bf(_0x378ec7._0x7b4b42)]['fromDegrees'](_0x2b1d87[0x0],_0x2b1d87[0x1])));const _0x585f3d=Cesium$1[_0x1e26bf(0x189)][_0x1e26bf(0x185)](_0x2b1d87[0x0],_0x2b1d87[0x1],_0x3a8c4f);if(!_0x585f3d)return _0x366ed4;const _0x3b4c74=Cesium$1['SceneTransforms']['wgs84ToWindowCoordinates'](_0x16d890,_0x585f3d);if(!_0x3b4c74)return _0x366ed4;if(_0x16d890['echartsDepthTest']&&_0x16d890['mode']===Cesium$1[_0x1e26bf(0x161)]['SCENE3D']){const _0x2d693e=new Cesium$1['EllipsoidalOccluder'](_0x16d890['globe']['ellipsoid'],_0x16d890['camera']['positionWC']),_0x3cb951=_0x2d693e['isPointVisible'](_0x585f3d);if(!_0x3cb951)return _0x366ed4;}return[_0x3b4c74['x']-this['_mapOffset'][0x0],_0x3b4c74['y']-this['_mapOffset'][0x1]];}['getViewRect'](){const _0x4fbc28=this['_api'];return new echarts__namespace['graphic']['BoundingRect'](0x0,0x0,_0x4fbc28['getWidth'](),_0x4fbc28['getHeight']());}['getRoamTransform'](){return echarts__namespace['matrix']['create']();}}function _0x3f05(){const _0x4f4617=['series','_mars3d_scene','off','1151784tHvxYQ','mars3dMap','forEach','pointerEvents','scene','__esModule','lat','addEventListener','onByQuery','setEchartsOption','clientWidth','init','setMapOffset','clampToGround','moveHandler','fromDegrees','_mapOffset','_echartsInstance','7518440ASKaNT','Cartesian3','3562lQdQiX','1376541AbHkEI','coords','_addedHook','Cartographic','data','layer','2701531rWdCZs','options','get','defineProperty','SceneMode','postRender','getRectangle','_map','lng','style','1065540tLdjpZ','_echartsContainer','25621048CrUnJe','registerAction','removeChild','Cesium','664WDcIfO','width','getOwnPropertyDescriptor','_createChartOverlay','canvas','create'];_0x3f05=function(){return _0x4f4617;};return _0x3f05();}CompositeCoordinateSystem['dimensions']=['lng',_0x37bc13(0x17c)],CompositeCoordinateSystem[_0x37bc13(0x172)]=function(_0x25f3de,_0x472ff5){const _0x1144b5={_0x438d64:0x177},_0x1b4215=_0x37bc13;let _0x28ee01;const _0x3e2acb=_0x25f3de['scheduler']['ecInstance']['_mars3d_scene'];_0x25f3de['eachComponent'](_0x1b4215(_0x1144b5._0x438d64),function(_0x5d41a1){const _0x40e434=_0x1b4215,_0x69b75a=_0x472ff5['getZr']()['painter'];if(!_0x69b75a)return;!_0x28ee01&&(_0x28ee01=new CompositeCoordinateSystem(_0x3e2acb,_0x472ff5)),_0x5d41a1['coordinateSystem']=_0x28ee01,_0x28ee01[_0x40e434(0x182)](_0x5d41a1['__mapOffset']||[0x0,0x0]);}),_0x25f3de['eachSeries'](function(_0x499337){_0x499337['get']('coordinateSystem')==='mars3dMap'&&(!_0x28ee01&&(_0x28ee01=new CompositeCoordinateSystem(_0x3e2acb,_0x472ff5)),_0x499337['coordinateSystem']=_0x28ee01);});};if(echarts__namespace!==null&&echarts__namespace!==void 0x0&&echarts__namespace[_0x37bc13(0x181)])echarts__namespace['registerCoordinateSystem'](_0x37bc13(0x177),CompositeCoordinateSystem),echarts__namespace[_0x37bc13(0x16a)]({'type':'mars3dMapRoam','event':'mars3dMapRoam','update':'updateLayout'},function(_0x2f2a2d,_0x505888){}),echarts__namespace['extendComponentModel']({'type':'mars3dMap','getBMap':function(){const _0xd78201={_0x303c6b:0x174},_0x2e7a07=_0x37bc13;return this[_0x2e7a07(_0xd78201._0x303c6b)];},'defaultOption':{'roam':![]}}),echarts__namespace['extendComponentView']({'type':'mars3dMap','init':function(_0x504684,_0xa00aa7){const _0x32287b={_0x2d356d:0x17a,_0x2d66cb:0x162,_0x4ae86b:0x17d,_0x19ade3:0x184},_0x25c0af=_0x37bc13;this['api']=_0xa00aa7,this['scene']=_0x504684['scheduler']['ecInstance']['_mars3d_scene'],this[_0x25c0af(_0x32287b._0x2d356d)][_0x25c0af(_0x32287b._0x2d66cb)][_0x25c0af(_0x32287b._0x4ae86b)](this[_0x25c0af(_0x32287b._0x19ade3)],this);},'moveHandler':function(_0x5e02dd,_0x573f64){this['api']['dispatchAction']({'type':'mars3dMapRoam'});},'render':function(_0x1e3b69,_0x58139b,_0x397a68){},'dispose':function(_0x265268){const _0x215510={_0x292e05:0x162},_0x53ef49=_0x37bc13;this['scene'][_0x53ef49(_0x215510._0x292e05)]['removeEventListener'](this['moveHandler'],this);}});else throw new Error('请引入\x20echarts\x20库\x20');const Cesium=mars3d__namespace[_0x37bc13(0x16c)],BaseLayer=mars3d__namespace['layer']['BaseLayer'];class EchartsLayer extends BaseLayer{constructor(_0x5e6f29={}){const _0x18016a={_0x5c9fe9:0x179},_0x3ea7db=_0x37bc13;super(_0x5e6f29),this['_pointerEvents']=this['options'][_0x3ea7db(_0x18016a._0x5c9fe9)];}get[_0x37bc13(0x15c)](){return this['_echartsInstance'];}get['pointerEvents'](){return this['_pointerEvents'];}set[_0x37bc13(0x179)](_0x93bae8){const _0x2a4934={_0x127ebb:0x168,_0x5368da:0x179},_0x298bdc=_0x37bc13;this['_pointerEvents']=_0x93bae8,this['_echartsContainer']&&(_0x93bae8?this[_0x298bdc(_0x2a4934._0x127ebb)]['style'][_0x298bdc(_0x2a4934._0x5368da)]='all':this[_0x298bdc(_0x2a4934._0x127ebb)]['style'][_0x298bdc(_0x2a4934._0x5368da)]='none');}['_setOptionsHook'](_0xee7674,_0x47574a){this['setEchartsOption'](_0xee7674);}['_showHook'](_0x298e31){_0x298e31?this['_echartsContainer']['style']['visibility']='visible':this['_echartsContainer']['style']['visibility']='hidden';}['_mountedHook'](){const _0x29c5ad={_0x26de7a:0x15e,_0x2f66cc:0x17a},_0x3701dd=_0x37bc13;this['_map']['scene']['echartsDepthTest']=this['options']['depthTest']??!![],this['_map']['scene']['echartsAutoHeight']=this[_0x3701dd(_0x29c5ad._0x26de7a)][_0x3701dd(0x183)]??![],this['_map'][_0x3701dd(_0x29c5ad._0x2f66cc)]['echartsFixedHeight']=this['options']['fixedHeight']??0x0;}[_0x37bc13(0x159)](){const _0x60dd06={_0x7dcf7e:0x181,_0x3ec84e:0x187},_0x52e3be=_0x37bc13;this['_echartsContainer']=this['_createChartOverlay'](),this['_echartsInstance']=echarts__namespace[_0x52e3be(_0x60dd06._0x7dcf7e)](this[_0x52e3be(0x168)]),this[_0x52e3be(_0x60dd06._0x3ec84e)]['_mars3d_scene']=this['_map']['scene'],this['setEchartsOption'](this['options']);}['_removedHook'](){const _0x13e1b5={_0x195eb3:0x187},_0x2a2988=_0x37bc13;this['_echartsInstance']&&(this['_echartsInstance']['clear'](),this[_0x2a2988(_0x13e1b5._0x195eb3)]['dispose'](),delete this[_0x2a2988(0x187)]),this['_echartsContainer']&&(this[_0x2a2988(0x164)]['container'][_0x2a2988(0x16b)](this['_echartsContainer']),delete this['_echartsContainer']);}[_0x37bc13(0x170)](){const _0x246c31={_0x24b6f9:0x180,_0x48b9bb:0x166},_0x42064b=_0x37bc13,_0x320d5e=mars3d__namespace['DomUtil']['create']('div','mars3d-echarts',this['_map']['container']);return _0x320d5e['id']=this['id'],_0x320d5e[_0x42064b(0x166)]['position']='absolute',_0x320d5e['style']['top']='0px',_0x320d5e['style']['left']='0px',_0x320d5e[_0x42064b(0x166)][_0x42064b(0x16e)]=this['_map']['scene']['canvas'][_0x42064b(_0x246c31._0x24b6f9)]+'px',_0x320d5e[_0x42064b(_0x246c31._0x48b9bb)]['height']=this['_map']['scene']['canvas']['clientHeight']+'px',_0x320d5e['style'][_0x42064b(0x179)]=this['_pointerEvents']?'all':'none',_0x320d5e['style']['zIndex']=this[_0x42064b(0x15e)]['zIndex']??0x9,_0x320d5e;}['resize'](){const _0x209275={_0x5b9234:0x16e},_0x4ac2a1=_0x37bc13;if(!this['_echartsInstance'])return;this['_echartsContainer']['style'][_0x4ac2a1(_0x209275._0x5b9234)]=this[_0x4ac2a1(0x164)]['scene'][_0x4ac2a1(0x171)]['clientWidth']+'px',this['_echartsContainer'][_0x4ac2a1(0x166)]['height']=this['_map']['scene']['canvas']['clientHeight']+'px',this['_echartsInstance']['resize']();}[_0x37bc13(0x17f)](_0xf3398b,_0x59c526,_0x4a7ecc){const _0x580945={_0x971fe1:0x177},_0xd60f70=_0x37bc13;this['_echartsInstance']&&(_0xf3398b['mars3dMap']=_0xf3398b[_0xd60f70(_0x580945._0x971fe1)]||{},this['_echartsInstance']['setOption'](_0xf3398b,_0x59c526,_0x4a7ecc));}[_0x37bc13(0x163)](_0x4305c4){const _0x55b400={_0x2c22e7:0x173},_0x451bf8=_0x37bc13;let _0xde83cc,_0xd26d13,_0x15e700,_0x23ed96;function _0x34aadc(_0x20c993){if(!Array['isArray'](_0x20c993))return;const _0x45ea5f=_0x20c993[0x0]||0x0,_0x4a917d=_0x20c993[0x1]||0x0;_0x45ea5f!==0x0&&_0x4a917d!==0x0&&(_0xde83cc===undefined?(_0xde83cc=_0x45ea5f,_0xd26d13=_0x45ea5f,_0x15e700=_0x4a917d,_0x23ed96=_0x4a917d):(_0xde83cc=Math['min'](_0xde83cc,_0x45ea5f),_0xd26d13=Math['max'](_0xd26d13,_0x45ea5f),_0x15e700=Math['min'](_0x15e700,_0x4a917d),_0x23ed96=Math['max'](_0x23ed96,_0x4a917d)));}const _0x4ffe08=this[_0x451bf8(0x15e)][_0x451bf8(_0x55b400._0x2c22e7)];_0x4ffe08&&_0x4ffe08['forEach'](_0x2ea173=>{const _0x34de5a={_0x56417e:0x158},_0x37cf7f=_0x451bf8;_0x2ea173['data']&&_0x2ea173[_0x37cf7f(0x15b)]['forEach'](_0x192623=>{const _0x1f62dc=_0x37cf7f;if(_0x192623['value'])_0x34aadc(_0x192623['value']);else _0x192623[_0x1f62dc(_0x34de5a._0x56417e)]&&_0x192623[_0x1f62dc(0x158)][_0x1f62dc(0x178)](_0x24db51=>{_0x34aadc(_0x24db51);});});});if(_0xde83cc===0x0&&_0x15e700===0x0&&_0xd26d13===0x0&&_0x23ed96===0x0)return null;return _0x4305c4!==null&&_0x4305c4!==void 0x0&&_0x4305c4['isFormat']?{'xmin':_0xde83cc,'xmax':_0xd26d13,'ymin':_0x15e700,'ymax':_0x23ed96}:Cesium['Rectangle'][_0x451bf8(0x185)](_0xde83cc,_0x15e700,_0xd26d13,_0x23ed96);}['on'](_0x1bb09f,_0x446d61,_0x2315e2){const _0xbfc46b={_0x1ab28b:0x187},_0x8d4403=_0x37bc13;return this[_0x8d4403(_0xbfc46b._0x1ab28b)]['on'](_0x1bb09f,_0x446d61,_0x2315e2||this),this;}[_0x37bc13(0x17e)](_0x397402,_0x1da8ac,_0x193ebf,_0x3c4dcf){const _0x3cd70=_0x37bc13;return this[_0x3cd70(0x187)]['on'](_0x397402,_0x1da8ac,_0x193ebf,_0x3c4dcf||this),this;}['off'](_0x36674a,_0x3f8f8a,_0x498e0d){const _0x229943=_0x37bc13;return this['_echartsInstance'][_0x229943(0x175)](_0x36674a,_0x3f8f8a,_0x498e0d||this),this;}}mars3d__namespace['LayerUtil']['register']('echarts',EchartsLayer),mars3d__namespace[_0x37bc13(0x15c)]['EchartsLayer']=EchartsLayer,mars3d__namespace['echarts']=echarts__namespace,exports['EchartsLayer']=EchartsLayer,Object['keys'](echarts)['forEach'](function(_0x5b4de3){const _0x472098={_0x3d911a:0x160},_0x361181=_0x37bc13;if(_0x5b4de3!=='default'&&!exports['hasOwnProperty'](_0x5b4de3))Object[_0x361181(_0x472098._0x3d911a)](exports,_0x5b4de3,{'enumerable':!![],'get':function(){return echarts[_0x5b4de3];}});}),Object['defineProperty'](exports,'__esModule',{'value':!![]});
}));
