/**
 * Mars3D平台插件,结合heatmap可视化功能插件  mars3d-heatmap
 *
 * 版本信息：v3.6.7
 * 编译日期：2023-09-25 10:02:19
 * 版权所有：Copyright by 火星科技  http://mars3d.cn
 * 使用单位：免费公开版 ，2023-03-17
 */
(function (global, factory) {
  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, (window.mars3d || require('mars3d')), (window.h337 || require('@mars3d/heatmap.js'))) :
  typeof define === 'function' && define.amd ? define(['exports', 'mars3d', '@mars3d/heatmap.js'], factory) :
  (global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory(global["mars3d-heatmap"] = {}, global.mars3d, global.h337));
})(this, (function (exports, mars3d, h337) { 
'use strict';function _0x5dee(_0x2f472d,_0x4697a4){const _0x4fdbbe=_0x4fdb();return _0x5dee=function(_0x5deeac,_0x16ab09){_0x5deeac=_0x5deeac-0xa4;let _0x233feb=_0x4fdbbe[_0x5deeac];return _0x233feb;},_0x5dee(_0x2f472d,_0x4697a4);}const _0x20858c=_0x5dee;(function(_0x45faef,_0x291c85){const _0x19ac49={_0x6bc188:0xdf,_0x4ef64e:0xae,_0xb649a2:0xf3,_0x458ea4:0xc7},_0x51ee4e=_0x5dee,_0xeb9854=_0x45faef();while(!![]){try{const _0x31ea22=parseInt(_0x51ee4e(_0x19ac49._0x6bc188))/0x1+-parseInt(_0x51ee4e(0xe0))/0x2+parseInt(_0x51ee4e(0xd8))/0x3*(-parseInt(_0x51ee4e(_0x19ac49._0x4ef64e))/0x4)+-parseInt(_0x51ee4e(0xeb))/0x5+parseInt(_0x51ee4e(_0x19ac49._0xb649a2))/0x6*(parseInt(_0x51ee4e(0xf0))/0x7)+parseInt(_0x51ee4e(0xed))/0x8+parseInt(_0x51ee4e(_0x19ac49._0x458ea4))/0x9;if(_0x31ea22===_0x291c85)break;else _0xeb9854['push'](_0xeb9854['shift']());}catch(_0xa7f3b1){_0xeb9854['push'](_0xeb9854['shift']());}}}(_0x4fdb,0x61839));function _interopNamespace(_0x1b8ecb){const _0x220951={_0x272f46:0xda},_0x273046=_0x5dee;if(_0x1b8ecb&&_0x1b8ecb[_0x273046(_0x220951._0x272f46)])return _0x1b8ecb;var _0x25665d=Object['create'](null);return _0x1b8ecb&&Object[_0x273046(0xe7)](_0x1b8ecb)['forEach'](function(_0x3bf902){const _0x5db542=_0x273046;if(_0x3bf902!==_0x5db542(0xd4)){var _0x3f63f5=Object['getOwnPropertyDescriptor'](_0x1b8ecb,_0x3bf902);Object['defineProperty'](_0x25665d,_0x3bf902,_0x3f63f5['get']?_0x3f63f5:{'enumerable':!![],'get':function(){return _0x1b8ecb[_0x3bf902];}});}}),_0x25665d['default']=_0x1b8ecb,_0x25665d;}var mars3d__namespace=_interopNamespace(mars3d),h337__namespace=_interopNamespace(h337),HeatMaterial='uniform\x20sampler2D\x20image;\x0a\x0aczm_material\x20czm_getMaterial(czm_materialInput\x20materialInput)\x20{\x0a\x20\x20czm_material\x20material\x20=\x20czm_getDefaultMaterial(materialInput);\x0a\x20\x20vec2\x20st\x20=\x20materialInput.st;\x0a\x20\x20vec4\x20colorImage\x20=\x20texture(image,\x20st);\x0a\x20\x20if(colorImage.rgb\x20==\x20vec3(1.0)\x20||\x20colorImage.rgb\x20==\x20vec3(0.0))\x20{\x0a\x20\x20\x20\x20discard;\x0a\x20\x20}\x0a\x20\x20material.diffuse\x20=\x20colorImage.rgb;\x0a\x20\x20material.alpha\x20=\x20colorImage.a;\x0a\x20\x20return\x20material;\x0a}\x0a';if(!h337__namespace['create'])throw new Error('请引入\x20heatmap.js\x20库\x20');function _0x4fdb(){const _0x62ce0e=['StencilOperation','_heat','KEEP','arcBlurScale','LayerUtil','_map','VERTEX_FORMAT','graphic','maxCanvasSize','default','_rectangle','getPointData','xmin','87468UJUoBx','_graphic2','__esModule','_renderer','min','clientWidth','_getArcHeatCanvas','397111yXVerF','581560TCPlaK','rectangle','mercator2lonlat','_scale','RenderState','REPLACE','style','keys','setData','positions','Cartesian2','2631495jnhSIJ','PointTrans','1933584YCfNJy','_last_mBounds','ALWAYS','21aSBGOX','max','addLayer','207204FOmfFI','ymin','_mBoundsMax','heatStyle','merge','_container','px;','push','xmax','ctx','_positions','uniforms','image','_layer','div','round','coordinates','8WlQvpx','parse','options','_createGraphic','EllipsoidSurfaceAppearance','Material','DomUtil','_graphic','lat','value','fromCache','data','image/png','ymax','getImageData','_setOptionsHook','Color','layer','configure','_mountedHook','body','minCanvasSize','setPositions','EPSG:3857','lng','4791573uencRw','_updatePositionsHook','_createArcGraphic','RectanglePrimitive'];_0x4fdb=function(){return _0x62ce0e;};return _0x4fdb();}const Cesium=mars3d__namespace['Cesium'],BaseLayer=mars3d__namespace[_0x20858c(0xbf)]['BaseLayer'],DEF_HEATSTYLE={'maxOpacity':0.8,'minOpacity':0.1,'blur':0.85,'radius':0x19,'gradient':{0.4:'blue',0.6:'green',0.8:'yellow',0.9:'red'}},DEF_STYLE={'arcRadiusScale':1.5,'arcBlurScale':1.5,'vertexFormat':Cesium['EllipsoidSurfaceAppearance'][_0x20858c(0xd1)]};class HeatLayer extends BaseLayer{constructor(_0x3f45a4={}){const _0x226789={_0x4e31c9:0xb0,_0x2b41f8:0xc2,_0x3e4820:0xdd,_0x26574f:0xb0,_0x381da0:0xdc,_0x3abada:0xc3},_0x1f4e21=_0x20858c;super(_0x3f45a4),this[_0x1f4e21(0xb0)]['maxCanvasSize']=this[_0x1f4e21(_0x226789._0x4e31c9)]['maxCanvasSize']??document[_0x1f4e21(_0x226789._0x2b41f8)][_0x1f4e21(_0x226789._0x3e4820)],this[_0x1f4e21(_0x226789._0x26574f)]['maxCanvasSize']=Math[_0x1f4e21(_0x226789._0x381da0)](this[_0x1f4e21(_0x226789._0x4e31c9)]['maxCanvasSize'],0x1388),this['options'][_0x1f4e21(0xc3)]=this['options']['minCanvasSize']??document['body']['clientHeight'],this['options'][_0x1f4e21(_0x226789._0x3abada)]=Math[_0x1f4e21(0xf1)](this['options']['minCanvasSize'],0x2bc),this['options']['heatStyle']={...DEF_HEATSTYLE,...this[_0x1f4e21(0xb0)]['heatStyle']},this['options'][_0x1f4e21(0xe6)]={...DEF_STYLE,...this['options'][_0x1f4e21(0xe6)]};}get['layer'](){return this['_layer'];}get[_0x20858c(0xf6)](){return this['options']['heatStyle'];}set['heatStyle'](_0x4fb832){const _0x248c91={_0x338250:0xb0},_0x5f539d=_0x20858c;this[_0x5f539d(0xb0)]['heatStyle']=mars3d__namespace['Util'][_0x5f539d(0xf7)](this[_0x5f539d(0xb0)]['heatStyle'],_0x4fb832),this[_0x5f539d(0xcc)]&&(this[_0x5f539d(0xcc)]['configure'](this[_0x5f539d(_0x248c91._0x338250)]['heatStyle']),this['_updatePositionsHook'](!![]));}get['style'](){return this['options']['style'];}set['style'](_0x47f72f){const _0x5a5a8c={_0x4cf5f3:0xf7},_0x244691=_0x20858c;this[_0x244691(0xb0)]['style']=mars3d__namespace['Util'][_0x244691(_0x5a5a8c._0x4cf5f3)](this['options'][_0x244691(0xe6)],_0x47f72f);}get['positions'](){const _0x2405f1={_0x16e26f:0xa7},_0x46a328=_0x20858c;return this[_0x46a328(_0x2405f1._0x16e26f)];}set['positions'](_0xdd8162){const _0x1d24ce=_0x20858c;this[_0x1d24ce(0xc4)](_0xdd8162);}get[_0x20858c(0xad)](){const _0x45844b=[];return this['points']['forEach'](_0x4b4d78=>{_0x45844b['push'](_0x4b4d78['toArray']());}),_0x45844b;}get['rectangle'](){return this['_rectangle'];}[_0x20858c(0xbd)](_0x4ea240,_0x61f2c5){const _0x1cb829=_0x20858c;_0x4ea240['positions']&&(this['positions']=_0x4ea240[_0x1cb829(0xe9)]);}[_0x20858c(0xc1)](){const _0xd4d016={_0x3233dc:0xc5},_0x43ca24=_0x20858c;this['style']['type']==='image'?this[_0x43ca24(0xaa)]=new mars3d__namespace['layer']['ImageLayer']({'crs':_0x43ca24(_0xd4d016._0x3233dc),'private':!![]}):this['_layer']=new mars3d__namespace['layer']['GraphicLayer']({'private':!![]});}['_addedHook'](){const _0xa1934e={_0x335f9f:0xd0,_0xc8972d:0xf2,_0x3ff4c7:0xf8,_0x933f27:0xb0},_0x4700d6=_0x20858c;this[_0x4700d6(_0xa1934e._0x335f9f)][_0x4700d6(_0xa1934e._0xc8972d)](this[_0x4700d6(0xaa)]),this[_0x4700d6(_0xa1934e._0x3ff4c7)]=mars3d__namespace['DomUtil']['create'](_0x4700d6(0xab),'mars3d-heatmap\x20mars3d-hideDiv',this[_0x4700d6(0xd0)]['container']),this['options']['positions']&&(this[_0x4700d6(0xe9)]=this['options']['positions']),this[_0x4700d6(_0xa1934e._0x933f27)]['flyTo']&&this['flyToByAnimationEnd']();}['_removedHook'](){const _0x9fa91d={_0x29f8cc:0xf8},_0x59b0d9=_0x20858c;this['_container']&&(mars3d__namespace['DomUtil']['remove'](this['_container']),delete this[_0x59b0d9(_0x9fa91d._0x29f8cc)]),this['clear'](),this['_map']['removeLayer'](this['_layer']);}['addPosition'](_0x106ef6,_0x2842a8){const _0x5323f0={_0x23bdfd:0xa7},_0x27de60=_0x20858c;this[_0x27de60(_0x5323f0._0x23bdfd)]=this['_positions']||[],this['_positions']['push'](_0x106ef6),this[_0x27de60(0xc8)](_0x2842a8);}['setPositions'](_0x3fb595,_0x465e4b){this['_positions']=_0x3fb595,this['_updatePositionsHook'](_0x465e4b);}['clear'](){const _0x6fc587={_0x35b95a:0xb5,_0xe1dae5:0xb5,_0x32ad4a:0xd9,_0x41c8c7:0xd9},_0x14874f=_0x20858c;this[_0x14874f(_0x6fc587._0x35b95a)]&&(this[_0x14874f(0xaa)]['removeGraphic'](this[_0x14874f(_0x6fc587._0xe1dae5)],!![]),delete this['_graphic']),this[_0x14874f(_0x6fc587._0x32ad4a)]&&(this['_layer']['removeGraphic'](this[_0x14874f(0xd9)],!![]),delete this[_0x14874f(_0x6fc587._0x41c8c7)]);}['_updatePositionsHook'](_0x5c72b6){const _0x22b720={_0x36b08b:0xd5,_0x231f76:0xb5,_0x337dbb:0xa8,_0x2e03a0:0xb5,_0x5718bc:0xa8,_0x2465fb:0xb5,_0x164a32:0xc9,_0x53d34f:0xa9,_0x318c3c:0xb1},_0x52173c=_0x20858c;if(!this['show']||!this[_0x52173c(0xd0)]||!this['positions']||this['positions']['length']===0x0)return this;const _0x267c21=this['_getHeatCanvas']();if(this['style']['type']==='image')this['_layer']['setOptions']({'url':_0x267c21['toDataURL'](_0x52173c(0xba)),'rectangle':this[_0x52173c(_0x22b720._0x36b08b)],'opacity':this['style']['opacity']});else this['style']['arc']?this[_0x52173c(_0x22b720._0x231f76)]&&_0x5c72b6?(this[_0x52173c(_0x22b720._0x231f76)][_0x52173c(_0x22b720._0x337dbb)][_0x52173c(0xa9)]=_0x267c21,this[_0x52173c(_0x22b720._0x2e03a0)]['uniforms']['bumpMap']=this['_getArcHeatCanvas'](),this['_graphic2']&&(this['_graphic2'][_0x52173c(_0x22b720._0x5718bc)]['image']=_0x267c21,this['_graphic2']['uniforms']['bumpMap']=this[_0x52173c(_0x22b720._0x2465fb)]['uniforms']['bumpMap'])):this[_0x52173c(_0x22b720._0x164a32)](_0x267c21):this['_graphic']&&_0x5c72b6?this[_0x52173c(_0x22b720._0x231f76)]['uniforms'][_0x52173c(_0x22b720._0x53d34f)]=_0x267c21:this[_0x52173c(_0x22b720._0x318c3c)](_0x267c21);return this;}['_createGraphic'](_0x29c015){const _0x14abfd={_0x2cafe0:0xb2},_0x2f61af=_0x20858c;this['clear'](),this['_graphic']=new mars3d__namespace[(_0x2f61af(0xd2))]['RectanglePrimitive']({...this['options'],'rectangle':this['_rectangle'],'appearance':new Cesium[(_0x2f61af(_0x14abfd._0x2cafe0))]({'material':new Cesium[(_0x2f61af(0xb3))]({'fabric':{'uniforms':{'image':_0x29c015},'source':HeatMaterial},'translucent':!![]}),'flat':!![]})}),this['_layer']['addGraphic'](this['_graphic']);}['_createArcGraphic'](_0x1b6ade){const _0x16b4c0={_0x12701:0xef,_0x296f7d:0xcd,_0x5d53ad:0xf5,_0x337434:0xe6,_0x4a079e:0xb3,_0x4702d9:0xde,_0x709809:0xca,_0x5d5b9c:0xd9},_0xc3fcb5=_0x20858c;this['clear']();const _0x3cbf79=Cesium[_0xc3fcb5(0xe4)][_0xc3fcb5(0xb8)]({'cull':{'enabled':!![]},'depthTest':{'enabled':!![]},'stencilTest':{'enabled':!![],'frontFunction':Cesium['StencilFunction']['ALWAYS'],'frontOperation':{'fail':Cesium['StencilOperation']['KEEP'],'zFail':Cesium[_0xc3fcb5(0xcb)]['KEEP'],'zPass':Cesium['StencilOperation']['REPLACE']},'backFunction':Cesium['StencilFunction'][_0xc3fcb5(_0x16b4c0._0x12701)],'backOperation':{'fail':Cesium[_0xc3fcb5(0xcb)][_0xc3fcb5(_0x16b4c0._0x296f7d)],'zFail':Cesium[_0xc3fcb5(0xcb)]['KEEP'],'zPass':Cesium['StencilOperation'][_0xc3fcb5(0xe5)]},'reference':0x2,'mask':0x2},'blending':Cesium['BlendingState']['ALPHA_BLEND']}),_0x224214=Math['floor'](this[_0xc3fcb5(0xe6)]['diffHeight']??this[_0xc3fcb5(_0x16b4c0._0x5d53ad)]*0.02)+0.1;this['style']['diffHeight']&&delete this['style']['diffHeight'];const _0x571292=(this[_0xc3fcb5(_0x16b4c0._0x337434)]['splitNum'],0x64);let _0x34394c=Math['max'](this['_rectangle']['height'],this['_rectangle']['width']);this['style']['granularity']=_0x34394c/=_0x571292;const _0x5da245=new Cesium[(_0xc3fcb5(_0x16b4c0._0x4a079e))]({'fabric':{'uniforms':{'image':_0x1b6ade,'repeat':new Cesium[(_0xc3fcb5(0xea))](0x1,0x1),'color':new Cesium[(_0xc3fcb5(0xbe))](0x1,0x1,0x1,0x0),'bumpMap':this[_0xc3fcb5(_0x16b4c0._0x4702d9)]()},'source':HeatMaterial},'translucent':!![]}),_0x1fbc20=this[_0xc3fcb5(0xe6)]['arcDirection']||0x1;this['_graphic']=new mars3d__namespace['graphic'][(_0xc3fcb5(_0x16b4c0._0x709809))]({...this[_0xc3fcb5(0xb0)],'rectangle':this['_rectangle'],'appearance':new Cesium[(_0xc3fcb5(0xb2))]({'flat':!![],'aboveGround':!![],'renderState':_0x3cbf79,'material':_0x5da245,'vertexShaderSource':getVertexShaderSource(_0x224214*_0x1fbc20)})}),this['_layer']['addGraphic'](this['_graphic']),this['style']['arcDirection']===0x0&&(this[_0xc3fcb5(_0x16b4c0._0x5d5b9c)]=new mars3d__namespace['graphic']['RectanglePrimitive']({...this[_0xc3fcb5(0xb0)],'rectangle':this['_rectangle'],'appearance':new Cesium['EllipsoidSurfaceAppearance']({'flat':!![],'aboveGround':!![],'renderState':_0x3cbf79,'material':_0x5da245,'vertexShaderSource':getVertexShaderSource(-_0x224214)})}),this[_0xc3fcb5(0xaa)]['addGraphic'](this['_graphic2']));}['getRectangle'](_0x424907){const _0x3fb56b=_0x20858c;return _0x424907!==null&&_0x424907!==void 0x0&&_0x424907['isFormat']&&this['_rectangle']?mars3d__namespace['PolyUtil']['formatRectangle'](this[_0x3fb56b(0xd5)]):this['_rectangle'];}['_getHeatCanvas'](){const _0x16d176={_0x45d277:0xbb,_0x2a600b:0xf4,_0x548ab7:0xf1,_0x22fe28:0xf5,_0x8ed9e5:0xd3,_0x1982b5:0xc3,_0x470eb4:0xd5,_0x47920e:0xd7,_0x3437bc:0xb0,_0x275876:0xee,_0x5bc783:0xcc,_0x24726c:0xc0,_0x5994b0:0xe8},_0x2d622c={_0x2850c8:0xa4},_0x4f36ae={_0x10ffb0:0xe1,_0x388568:0xdc},_0x374c8d=_0x20858c,_0x463a3a=this['_positions'],_0x151856=[];let _0x5e2a17,_0x241594,_0x2528c5,_0x33cad4;_0x463a3a['forEach'](_0xae23b6=>{const _0x241372=_0x5dee,_0x29684a=mars3d__namespace['LngLatPoint']['parse'](_0xae23b6);if(!_0x29684a)return;_0x29684a['value']=_0xae23b6[_0x241372(0xb7)]||0x1,!this['options'][_0x241372(_0x4f36ae._0x10ffb0)]&&(_0x5e2a17===undefined?(_0x5e2a17=_0x29684a['lng'],_0x241594=_0x29684a['lng'],_0x2528c5=_0x29684a[_0x241372(0xb6)],_0x33cad4=_0x29684a['lat']):(_0x5e2a17=Math[_0x241372(_0x4f36ae._0x388568)](_0x5e2a17,_0x29684a['lng']),_0x241594=Math['max'](_0x241594,_0x29684a[_0x241372(0xc6)]),_0x2528c5=Math['min'](_0x2528c5,_0x29684a['lat']),_0x33cad4=Math['max'](_0x33cad4,_0x29684a[_0x241372(0xb6)]))),_0x151856['push'](_0x29684a);});_0x5e2a17===_0x241594&&(_0x5e2a17-=0.000001,_0x241594+=0.000001);_0x2528c5===_0x33cad4&&(_0x2528c5-=0.000001,_0x33cad4+=0.000001);let _0x4c6e46=this['options']['rectangle']||{'xmin':_0x5e2a17,'xmax':_0x241594,'ymin':_0x2528c5,'ymax':_0x33cad4};const _0x45b48e=getMercatorBounds(_0x4c6e46),_0x5dfe39=Math['abs'](_0x45b48e[_0x374c8d(0xa5)]-_0x45b48e[_0x374c8d(0xd7)]),_0x53ad4c=Math['abs'](_0x45b48e[_0x374c8d(_0x16d176._0x45d277)]-_0x45b48e[_0x374c8d(_0x16d176._0x2a600b)]),_0x3a5923=Math[_0x374c8d(_0x16d176._0x548ab7)](_0x5dfe39,_0x53ad4c),_0x179a9b=Math[_0x374c8d(0xdc)](_0x5dfe39,_0x53ad4c);this[_0x374c8d(_0x16d176._0x22fe28)]=_0x3a5923;let _0x312e5b=0x1;if(_0x3a5923>this['options']['maxCanvasSize'])_0x312e5b=_0x3a5923/this[_0x374c8d(0xb0)][_0x374c8d(_0x16d176._0x8ed9e5)],_0x179a9b/_0x312e5b<this['options']['minCanvasSize']&&(_0x312e5b=_0x179a9b/this['options'][_0x374c8d(_0x16d176._0x1982b5)]);else _0x179a9b<this['options'][_0x374c8d(0xc3)]&&(_0x312e5b=_0x179a9b/this['options']['minCanvasSize'],_0x3a5923/_0x312e5b>this['options'][_0x374c8d(0xd3)]&&(_0x312e5b=_0x3a5923/this['options']['maxCanvasSize']));const _0x4ce9c4=this['heatStyle']['radius']*1.5,_0x21ac5e=_0x5dfe39/_0x312e5b+_0x4ce9c4*0x2,_0x22156c=_0x53ad4c/_0x312e5b+_0x4ce9c4*0x2,_0x106a8c=_0x4ce9c4*_0x312e5b;_0x45b48e['xmin']-=_0x106a8c,_0x45b48e['ymin']-=_0x106a8c,_0x45b48e['xmax']+=_0x106a8c,_0x45b48e[_0x374c8d(0xbb)]+=_0x106a8c,this['_scale']=_0x312e5b,_0x4c6e46=geLatLngBounds(_0x45b48e),this[_0x374c8d(_0x16d176._0x470eb4)]=Cesium['Rectangle']['fromDegrees'](_0x4c6e46[_0x374c8d(_0x16d176._0x47920e)],_0x4c6e46[_0x374c8d(0xf4)],_0x4c6e46['xmax'],_0x4c6e46['ymax']);let _0xd3dae5=_0x151856[0x0]['value']??0x1,_0x2c6419=_0x151856[0x0][_0x374c8d(0xb7)]??0x0;const _0x147896=[];_0x151856['forEach'](_0x239cb6=>{const _0x200b9e=_0x374c8d,_0x445953=mars3d__namespace['PointTrans']['lonlat2mercator']([_0x239cb6[_0x200b9e(0xc6)],_0x239cb6['lat']]),_0x469460=_0x239cb6['value']||0x1,_0x25ae70=Math[_0x200b9e(0xac)]((_0x445953[0x0]-_0x45b48e['xmin'])/_0x312e5b),_0x1a62f9=Math['round']((_0x45b48e[_0x200b9e(0xbb)]-_0x445953[0x1])/_0x312e5b);_0xd3dae5=Math['max'](_0xd3dae5,_0x469460),_0x2c6419=Math['min'](_0x2c6419,_0x469460),_0x147896[_0x200b9e(_0x2d622c._0x2850c8)]({'x':_0x25ae70,'y':_0x1a62f9,'value':_0x469460});});const _0x1d5ea6={'min':this[_0x374c8d(_0x16d176._0x3437bc)]['min']??_0x2c6419,'max':this[_0x374c8d(_0x16d176._0x3437bc)]['max']??_0xd3dae5,'data':_0x147896};this['_last_heatData']=_0x1d5ea6;if(!this['_last_mBounds']||_0x45b48e['xmin']!==this['_last_mBounds']['xmin']||_0x45b48e['ymin']!==this[_0x374c8d(_0x16d176._0x275876)]['ymin']||_0x45b48e['xmax']!==this[_0x374c8d(0xee)]['xmax']||_0x45b48e[_0x374c8d(_0x16d176._0x45d277)]!==this[_0x374c8d(_0x16d176._0x275876)]['ymax']){this['_last_mBounds']=_0x45b48e,this['_container']['style']['cssText']='width:'+_0x21ac5e+'px;height:'+_0x22156c+_0x374c8d(0xf9);const _0x36d1d1={...this['heatStyle'],'container':this['_container']};!this['_heat']?this[_0x374c8d(_0x16d176._0x5bc783)]=h337__namespace['create'](_0x36d1d1):this['_heat'][_0x374c8d(_0x16d176._0x24726c)](_0x36d1d1);}this['_heat'][_0x374c8d(_0x16d176._0x5994b0)](_0x1d5ea6);const _0x2a46fa=mars3d__namespace['DomUtil']['copyCanvas'](this['_heat']['_renderer']['canvas']);return _0x2a46fa;}['_getArcHeatCanvas'](){const _0x5b2ffb={_0x3f61a9:0xdb},_0x2a719e=_0x20858c;this['_heat']['configure']({'radius':this[_0x2a719e(0xf6)]['radius']*this['style']['arcRadiusScale'],'blur':this['heatStyle']['blur']*this[_0x2a719e(0xe6)][_0x2a719e(0xce)],'gradient':this['heatStyle']['gradientArc']||{0.25:'rgb(0,0,0)',0.55:'rgb(140,140,140)',0.85:'rgb(216,216,216)',0x1:'rgb(255,255,255)'}});const _0x406715=mars3d__namespace[_0x2a719e(0xb4)]['copyCanvas'](this[_0x2a719e(0xcc)][_0x2a719e(_0x5b2ffb._0x3f61a9)]['canvas']);return this['_heat']['configure'](this['options']['heatStyle']),_0x406715;}[_0x20858c(0xd6)](_0x50a8b1){const _0x5bf2bc={_0x2175c9:0xaf,_0x910f90:0xd7,_0x2bc864:0xbc},_0x136c65=_0x20858c,_0x30825e=mars3d__namespace['LngLatPoint'][_0x136c65(_0x5bf2bc._0x2175c9)](_0x50a8b1);if(!_0x30825e)return{};const _0x4411f0=mars3d__namespace[_0x136c65(0xec)]['lonlat2mercator']([_0x30825e['lng'],_0x30825e['lat']]),_0x822a9b=this[_0x136c65(0xee)],_0x2daac2=Math[_0x136c65(0xac)]((_0x4411f0[0x0]-_0x822a9b[_0x136c65(_0x5bf2bc._0x910f90)])/this[_0x136c65(0xe3)]),_0xe4dc47=Math['round']((_0x822a9b['ymax']-_0x4411f0[0x1])/this['_scale']),_0x2f94c8=this['_heat']['getValueAt']({'x':_0x2daac2,'y':_0xe4dc47}),_0x5dbb19=this['_heat']['_renderer'][_0x136c65(0xa6)][_0x136c65(_0x5bf2bc._0x2bc864)](_0x2daac2-0x1,_0xe4dc47-0x1,0x1,0x1)[_0x136c65(0xb9)];return{'x':_0x2daac2,'y':_0xe4dc47,'value':_0x2f94c8,'color':'rgba('+_0x5dbb19[0x0]+','+_0x5dbb19[0x1]+','+_0x5dbb19[0x2]+','+_0x5dbb19[0x3]+')'};}}mars3d__namespace[_0x20858c(0xcf)]['register']('heat',HeatLayer),mars3d__namespace[_0x20858c(0xbf)]['HeatLayer']=HeatLayer,mars3d__namespace['h337']=h337__namespace;function getMercatorBounds(_0x323ccc){const _0x438e4e={_0x2f7c28:0xd7,_0x1aa51f:0xec,_0x6d26da:0xbb},_0x1b643b=_0x20858c,_0x218dd9=mars3d__namespace['PointTrans']['lonlat2mercator']([_0x323ccc[_0x1b643b(_0x438e4e._0x2f7c28)],_0x323ccc['ymin']]),_0x4beb02=mars3d__namespace[_0x1b643b(_0x438e4e._0x1aa51f)]['lonlat2mercator']([_0x323ccc['xmax'],_0x323ccc[_0x1b643b(_0x438e4e._0x6d26da)]]);return{'xmin':_0x218dd9[0x0],'ymin':_0x218dd9[0x1],'xmax':_0x4beb02[0x0],'ymax':_0x4beb02[0x1]};}function geLatLngBounds(_0x160225){const _0x2b523d={_0x14942c:0xe2},_0x530131=_0x20858c,_0x2b78cf=mars3d__namespace['PointTrans']['mercator2lonlat']([_0x160225['xmin'],_0x160225['ymin']]),_0x33e784=mars3d__namespace['PointTrans'][_0x530131(_0x2b523d._0x14942c)]([_0x160225['xmax'],_0x160225[_0x530131(0xbb)]]);return{'xmin':_0x2b78cf[0x0],'ymin':_0x2b78cf[0x1],'xmax':_0x33e784[0x0],'ymax':_0x33e784[0x1]};}function getVertexShaderSource(_0x35875a){return'in\x20vec3\x20position3DHigh;\x0a\x20\x20in\x20vec3\x20position3DLow;\x0a\x20\x20in\x20vec2\x20st;\x0a\x20\x20in\x20float\x20batchId;\x0a\x20\x20uniform\x20sampler2D\x20bumpMap_3;\x0a\x20\x20out\x20vec3\x20v_positionMC;\x0a\x20\x20out\x20vec3\x20v_positionEC;\x0a\x20\x20out\x20vec2\x20v_st;\x0a\x0a\x20\x20void\x20main()\x0a\x20\x20{\x0a\x20\x20\x20\x20vec4\x20p\x20=\x20czm_computePosition();\x0a\x20\x20\x20\x20v_positionMC\x20=\x20position3DHigh\x20+\x20position3DLow;\x0a\x20\x20\x20\x20v_positionEC\x20=\x20(czm_modelViewRelativeToEye\x20*\x20p).xyz;\x0a\x20\x20\x20\x20v_st\x20=\x20st;\x0a\x20\x20\x20\x20vec4\x20color\x20=\x20texture(bumpMap_3,\x20v_st);\x0a\x20\x20\x20\x20float\x20centerBump\x20=\x20distance(vec3(0.0),color.rgb);\x0a\x20\x20\x20\x20vec3\x20upDir\x20=\x20normalize(v_positionMC.xyz);\x0a\x20\x20\x20\x20vec3\x20disPos\x20=\x20upDir\x20*\x20centerBump\x20*\x20'+_0x35875a+';\x0a\x20\x20\x20\x20p\x20+=vec4(disPos,0.0);\x0a\x20\x20\x20\x20gl_Position\x20=\x20czm_modelViewProjectionRelativeToEye\x20*\x20p;\x0a\x20\x20}\x0a';}exports['HeatLayer']=HeatLayer,Object['defineProperty'](exports,'__esModule',{'value':!![]});
}));
