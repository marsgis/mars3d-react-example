/**
 * Mars3D平台插件,结合heatmap可视化功能插件  mars3d-heatmap
 *
 * 版本信息：v3.6.5
 * 编译日期：2023-09-12 12:42:16
 * 版权所有：Copyright by 火星科技  http://mars3d.cn
 * 使用单位：免费公开版 ，2023-03-17
 */
(function (global, factory) {
  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, (window.mars3d || require('mars3d')), (window.h337 || require('@mars3d/heatmap.js'))) :
  typeof define === 'function' && define.amd ? define(['exports', 'mars3d', '@mars3d/heatmap.js'], factory) :
  (global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory(global["mars3d-heatmap"] = {}, global.mars3d, global.h337));
})(this, (function (exports, mars3d, h337) { 
'use strict';const _0x51509a=_0x19e4;(function(_0x4155ca,_0x6b22a0){const _0x26c0bc={_0x6a037e:0xaf,_0x3b2f9d:0xd5,_0x3c8630:0x88,_0x5a727a:0xad,_0x2ded36:0x9a},_0x50acee=_0x19e4,_0x5e7f2f=_0x4155ca();while(!![]){try{const _0x141546=-parseInt(_0x50acee(0xc4))/0x1*(parseInt(_0x50acee(_0x26c0bc._0x6a037e))/0x2)+-parseInt(_0x50acee(0xc7))/0x3*(parseInt(_0x50acee(0xa7))/0x4)+-parseInt(_0x50acee(0xb1))/0x5+parseInt(_0x50acee(0xa5))/0x6*(-parseInt(_0x50acee(0x87))/0x7)+-parseInt(_0x50acee(_0x26c0bc._0x3b2f9d))/0x8*(-parseInt(_0x50acee(0x85))/0x9)+-parseInt(_0x50acee(_0x26c0bc._0x3c8630))/0xa*(-parseInt(_0x50acee(0xd9))/0xb)+-parseInt(_0x50acee(_0x26c0bc._0x5a727a))/0xc*(-parseInt(_0x50acee(_0x26c0bc._0x2ded36))/0xd);if(_0x141546===_0x6b22a0)break;else _0x5e7f2f['push'](_0x5e7f2f['shift']());}catch(_0xed17df){_0x5e7f2f['push'](_0x5e7f2f['shift']());}}}(_0x4511,0xc3104));function _0x4511(){const _0x31b2cd=['PointTrans','positions','maxCanvasSize','LngLatPoint','xmax','bumpMap','_layer','4513518dnqVQv','lonlat2mercator','2790949EzOqXV','2979610cYpzkG','setPositions','defineProperty','length','_map','_container','ImageLayer','default','_graphic2','_graphic','type','xmin','max','radius','GraphicLayer','clear','uniforms','body','3546478wjBObF','_removedHook','LayerUtil','RectanglePrimitive','parse','lat','rgb(140,140,140)','DomUtil','_addedHook','ymin','_positions','18EqbUSp','opacity','10236JklGBI','addLayer','merge','clientHeight','_rectangle','lng','84zARGUM','Rectangle','2yqlpjk','div','5489080mSjDHA','arcRadiusScale','Util','getRectangle','options','style','toArray','forEach','heatStyle','BaseLayer','PolyUtil','_renderer','abs','value','graphic','EllipsoidSurfaceAppearance','minCanvasSize','_heat','Material','1053897KsIwWO','rgb(216,216,216)','ALPHA_BLEND','189vdfJqx','heat','ymax','diffHeight','min','rgb(255,255,255)','round','rectangle','mars3d-heatmap\x20mars3d-hideDiv','_updatePositionsHook','flyToByAnimationEnd','_getArcHeatCanvas','create','push','24GGggBD','_last_mBounds','layer','removeGraphic','33snWaJe','_scale'];_0x4511=function(){return _0x31b2cd;};return _0x4511();}function _interopNamespace(_0x401030){const _0xddf874={_0x7b6dd8:0xb8},_0x4ad17a=_0x19e4;if(_0x401030&&_0x401030['__esModule'])return _0x401030;var _0x3dd968=Object['create'](null);return _0x401030&&Object['keys'](_0x401030)[_0x4ad17a(_0xddf874._0x7b6dd8)](function(_0x4445d){const _0x51eaef=_0x4ad17a;if(_0x4445d!==_0x51eaef(0x8f)){var _0x2ba36e=Object['getOwnPropertyDescriptor'](_0x401030,_0x4445d);Object[_0x51eaef(0x8a)](_0x3dd968,_0x4445d,_0x2ba36e['get']?_0x2ba36e:{'enumerable':!![],'get':function(){return _0x401030[_0x4445d];}});}}),_0x3dd968['default']=_0x401030,_0x3dd968;}var mars3d__namespace=_interopNamespace(mars3d),h337__namespace=_interopNamespace(h337),HeatMaterial='uniform\x20sampler2D\x20image;\x0a\x0aczm_material\x20czm_getMaterial(czm_materialInput\x20materialInput)\x20{\x0a\x20\x20czm_material\x20material\x20=\x20czm_getDefaultMaterial(materialInput);\x0a\x20\x20vec2\x20st\x20=\x20materialInput.st;\x0a\x20\x20vec4\x20colorImage\x20=\x20texture(image,\x20st);\x0a\x20\x20if(colorImage.rgb\x20==\x20vec3(1.0)\x20||\x20colorImage.rgb\x20==\x20vec3(0.0))\x20{\x0a\x20\x20\x20\x20discard;\x0a\x20\x20}\x0a\x20\x20material.diffuse\x20=\x20colorImage.rgb;\x0a\x20\x20material.alpha\x20=\x20colorImage.a;\x0a\x20\x20return\x20material;\x0a}\x0a';if(!h337__namespace[_0x51509a(0xd3)])throw new Error('请引入\x20heatmap.js\x20库\x20');function _0x19e4(_0x3a4604,_0x3c0561){const _0x4511be=_0x4511();return _0x19e4=function(_0x19e4b6,_0x1d996d){_0x19e4b6=_0x19e4b6-0x84;let _0x31bb30=_0x4511be[_0x19e4b6];return _0x31bb30;},_0x19e4(_0x3a4604,_0x3c0561);}const Cesium=mars3d__namespace['Cesium'],BaseLayer=mars3d__namespace[_0x51509a(0xd7)][_0x51509a(0xba)],DEF_HEATSTYLE={'maxOpacity':0.8,'minOpacity':0.1,'blur':0.85,'radius':0x19,'gradient':{0.4:'blue',0.6:'green',0.8:'yellow',0.9:'red'}},DEF_STYLE={'arcRadiusScale':1.5,'arcBlurScale':1.5,'vertexFormat':Cesium[_0x51509a(0xc0)]['VERTEX_FORMAT']};class HeatLayer extends BaseLayer{constructor(_0x53e30e={}){const _0x3e31ce={_0x757190:0xdd,_0x2e683b:0xb5,_0xf02a1c:0xc1,_0x4c1ba4:0xb6},_0x4c0e99=_0x51509a;super(_0x53e30e),this['options']['maxCanvasSize']=this['options']['maxCanvasSize']??document['body']['clientWidth'],this['options'][_0x4c0e99(_0x3e31ce._0x757190)]=Math['min'](this[_0x4c0e99(_0x3e31ce._0x2e683b)]['maxCanvasSize'],0x1388),this['options'][_0x4c0e99(0xc1)]=this[_0x4c0e99(_0x3e31ce._0x2e683b)][_0x4c0e99(_0x3e31ce._0xf02a1c)]??document[_0x4c0e99(0x99)][_0x4c0e99(0xaa)],this[_0x4c0e99(0xb5)]['minCanvasSize']=Math['max'](this['options']['minCanvasSize'],0x2bc),this['options']['heatStyle']={...DEF_HEATSTYLE,...this['options']['heatStyle']},this['options']['style']={...DEF_STYLE,...this['options'][_0x4c0e99(_0x3e31ce._0x4c1ba4)]};}get['layer'](){const _0x1bb27e=_0x51509a;return this[_0x1bb27e(0x84)];}get[_0x51509a(0xb9)](){const _0x892f10=_0x51509a;return this[_0x892f10(0xb5)]['heatStyle'];}set['heatStyle'](_0x191592){const _0x8fbad={_0x1cb58c:0xb5,_0x192b36:0xa9,_0x852737:0xc2,_0x20c792:0xd0},_0x285858=_0x51509a;this[_0x285858(_0x8fbad._0x1cb58c)]['heatStyle']=mars3d__namespace['Util'][_0x285858(_0x8fbad._0x192b36)](this['options']['heatStyle'],_0x191592),this[_0x285858(_0x8fbad._0x852737)]&&(this['_heat']['configure'](this['options']['heatStyle']),this[_0x285858(_0x8fbad._0x20c792)](!![]));}get['style'](){const _0x583632={_0x4923fb:0xb6},_0x1a255a=_0x51509a;return this['options'][_0x1a255a(_0x583632._0x4923fb)];}set['style'](_0x199b4f){const _0x492e82=_0x51509a;this['options']['style']=mars3d__namespace[_0x492e82(0xb3)]['merge'](this['options'][_0x492e82(0xb6)],_0x199b4f);}get['positions'](){return this['_positions'];}set[_0x51509a(0xdc)](_0xa3b06f){const _0x272d2c={_0x4a1901:0x89},_0x2c4376=_0x51509a;this[_0x2c4376(_0x272d2c._0x4a1901)](_0xa3b06f);}get['coordinates'](){const _0x3101c3=[];return this['points']['forEach'](_0x5a323a=>{const _0x1f0b84=_0x19e4;_0x3101c3['push'](_0x5a323a[_0x1f0b84(0xb7)]());}),_0x3101c3;}get[_0x51509a(0xce)](){const _0x50b62e={_0x4dce12:0xab},_0x51d772=_0x51509a;return this[_0x51d772(_0x50b62e._0x4dce12)];}['_setOptionsHook'](_0x423e14,_0x43b484){_0x423e14['positions']&&(this['positions']=_0x423e14['positions']);}['_mountedHook'](){const _0x2f1d14={_0xe2dda5:0x8e},_0x3f57e9=_0x51509a;this[_0x3f57e9(0xb6)][_0x3f57e9(0x92)]==='image'?this['_layer']=new mars3d__namespace['layer'][(_0x3f57e9(_0x2f1d14._0xe2dda5))]({'crs':'EPSG:3857','private':!![]}):this['_layer']=new mars3d__namespace['layer'][(_0x3f57e9(0x96))]({'private':!![]});}[_0x51509a(0xa2)](){const _0x51187c={_0x250279:0xa1,_0x3e2186:0x8c,_0x82c88f:0xdc},_0x5a271e=_0x51509a;this['_map'][_0x5a271e(0xa8)](this['_layer']),this[_0x5a271e(0x8d)]=mars3d__namespace[_0x5a271e(_0x51187c._0x250279)]['create'](_0x5a271e(0xb0),_0x5a271e(0xcf),this[_0x5a271e(_0x51187c._0x3e2186)]['container']),this['options'][_0x5a271e(_0x51187c._0x82c88f)]&&(this['positions']=this['options'][_0x5a271e(0xdc)]),this['options']['flyTo']&&this[_0x5a271e(0xd1)]();}[_0x51509a(0x9b)](){this['_container']&&(mars3d__namespace['DomUtil']['remove'](this['_container']),delete this['_container']),this['clear'](),this['_map']['removeLayer'](this['_layer']);}['addPosition'](_0x4ec7fe,_0x50963c){const _0x5a7d83={_0x542760:0xd4},_0x92c13=_0x51509a;this['_positions']=this[_0x92c13(0xa4)]||[],this['_positions'][_0x92c13(_0x5a7d83._0x542760)](_0x4ec7fe),this['_updatePositionsHook'](_0x50963c);}[_0x51509a(0x89)](_0x25ffd1,_0x37bf73){const _0x5aae1f={_0x117472:0xd0},_0x2bdd12=_0x51509a;this['_positions']=_0x25ffd1,this[_0x2bdd12(_0x5aae1f._0x117472)](_0x37bf73);}['clear'](){const _0x3fa454={_0x458c15:0xd8,_0x34eb03:0x90,_0x31096a:0x90},_0x167e7d=_0x51509a;this['_graphic']&&(this['_layer'][_0x167e7d(_0x3fa454._0x458c15)](this['_graphic'],!![]),delete this['_graphic']),this[_0x167e7d(_0x3fa454._0x34eb03)]&&(this['_layer']['removeGraphic'](this[_0x167e7d(_0x3fa454._0x31096a)],!![]),delete this[_0x167e7d(0x90)]);}['_updatePositionsHook'](_0x585a67){const _0x49531a={_0x3adb16:0x8c,_0x29e726:0x8b,_0x5bbf79:0xb6,_0x389ae9:0x92,_0x4aec3e:0x91,_0x4c77df:0xe0},_0xf9bb72=_0x51509a;if(!this['show']||!this[_0xf9bb72(_0x49531a._0x3adb16)]||!this['positions']||this['positions'][_0xf9bb72(_0x49531a._0x29e726)]===0x0)return this;const _0x25dada=this['_getHeatCanvas']();if(this[_0xf9bb72(_0x49531a._0x5bbf79)][_0xf9bb72(_0x49531a._0x389ae9)]==='image')this['_layer']['setOptions']({'url':_0x25dada['toDataURL']('image/png'),'rectangle':this['_rectangle'],'opacity':this['style'][_0xf9bb72(0xa6)]});else this['style']['arc']?this['_graphic']&&_0x585a67?(this[_0xf9bb72(0x91)]['uniforms']['image']=_0x25dada,this['_graphic']['uniforms'][_0xf9bb72(0xe0)]=this['_getArcHeatCanvas'](),this['_graphic2']&&(this['_graphic2']['uniforms']['image']=_0x25dada,this['_graphic2'][_0xf9bb72(0x98)][_0xf9bb72(0xe0)]=this[_0xf9bb72(_0x49531a._0x4aec3e)]['uniforms'][_0xf9bb72(_0x49531a._0x4c77df)])):this['_createArcGraphic'](_0x25dada):this[_0xf9bb72(0x91)]&&_0x585a67?this[_0xf9bb72(0x91)]['uniforms']['image']=_0x25dada:this['_createGraphic'](_0x25dada);return this;}['_createGraphic'](_0x321ac5){const _0x2aa55a={_0x518931:0x97,_0x5db2b7:0x9d},_0x1f1a10=_0x51509a;this[_0x1f1a10(_0x2aa55a._0x518931)](),this['_graphic']=new mars3d__namespace['graphic'][(_0x1f1a10(_0x2aa55a._0x5db2b7))]({...this['options'],'rectangle':this['_rectangle'],'appearance':new Cesium['EllipsoidSurfaceAppearance']({'material':new Cesium[(_0x1f1a10(0xc3))]({'fabric':{'uniforms':{'image':_0x321ac5},'source':HeatMaterial},'translucent':!![]}),'flat':!![]})}),this['_layer']['addGraphic'](this['_graphic']);}['_createArcGraphic'](_0x5b3309){const _0x426f46={_0x19aa5e:0x97,_0x4d0316:0xc6,_0x3b96df:0xca,_0x30ea2a:0xd2,_0x2dba65:0xab,_0x4fe66f:0x84,_0x42757d:0xab},_0x41ecc4=_0x51509a;this[_0x41ecc4(_0x426f46._0x19aa5e)]();const _0x5f4e8b=Cesium['RenderState']['fromCache']({'cull':{'enabled':!![]},'depthTest':{'enabled':!![]},'stencilTest':{'enabled':!![],'frontFunction':Cesium['StencilFunction']['ALWAYS'],'frontOperation':{'fail':Cesium['StencilOperation']['KEEP'],'zFail':Cesium['StencilOperation']['KEEP'],'zPass':Cesium['StencilOperation']['REPLACE']},'backFunction':Cesium['StencilFunction']['ALWAYS'],'backOperation':{'fail':Cesium['StencilOperation']['KEEP'],'zFail':Cesium['StencilOperation']['KEEP'],'zPass':Cesium['StencilOperation']['REPLACE']},'reference':0x2,'mask':0x2},'blending':Cesium['BlendingState'][_0x41ecc4(_0x426f46._0x4d0316)]}),_0xfade18=Math['floor'](this['style']['diffHeight']??this['_mBoundsMax']*0.02)+0.1;this['style'][_0x41ecc4(_0x426f46._0x3b96df)]&&delete this['style']['diffHeight'];const _0x197d11=(this['style']['splitNum'],0x64);let _0x400c80=Math['max'](this['_rectangle']['height'],this['_rectangle']['width']);this['style']['granularity']=_0x400c80/=_0x197d11;const _0x4918a0=new Cesium['Material']({'fabric':{'uniforms':{'image':_0x5b3309,'repeat':new Cesium['Cartesian2'](0x1,0x1),'color':new Cesium['Color'](0x1,0x1,0x1,0x0),'bumpMap':this[_0x41ecc4(_0x426f46._0x30ea2a)]()},'source':HeatMaterial},'translucent':!![]}),_0x18fd51=this['style']['arcDirection']||0x1;this['_graphic']=new mars3d__namespace[(_0x41ecc4(0xbf))][(_0x41ecc4(0x9d))]({...this[_0x41ecc4(0xb5)],'rectangle':this[_0x41ecc4(_0x426f46._0x2dba65)],'appearance':new Cesium['EllipsoidSurfaceAppearance']({'flat':!![],'aboveGround':!![],'renderState':_0x5f4e8b,'material':_0x4918a0,'vertexShaderSource':getVertexShaderSource(_0xfade18*_0x18fd51)})}),this[_0x41ecc4(_0x426f46._0x4fe66f)]['addGraphic'](this['_graphic']),this['style']['arcDirection']===0x0&&(this['_graphic2']=new mars3d__namespace['graphic']['RectanglePrimitive']({...this['options'],'rectangle':this[_0x41ecc4(_0x426f46._0x42757d)],'appearance':new Cesium['EllipsoidSurfaceAppearance']({'flat':!![],'aboveGround':!![],'renderState':_0x5f4e8b,'material':_0x4918a0,'vertexShaderSource':getVertexShaderSource(-_0xfade18)})}),this['_layer']['addGraphic'](this['_graphic2']));}[_0x51509a(0xb4)](_0x15500a){const _0x5c5af0={_0x57cf0d:0xbb},_0x125b82=_0x51509a;return _0x15500a!==null&&_0x15500a!==void 0x0&&_0x15500a['isFormat']&&this['_rectangle']?mars3d__namespace[_0x125b82(_0x5c5af0._0x57cf0d)]['formatRectangle'](this['_rectangle']):this[_0x125b82(0xab)];}['_getHeatCanvas'](){const _0x1f967f={_0x43b8a0:0xbd,_0x597151:0xc1,_0x5a9946:0xb5,_0x2e2b37:0xdd,_0x251ea4:0x95,_0x5b4012:0xae,_0x864631:0xdf,_0x56c19b:0xbe,_0x38700d:0xb8,_0x47df77:0xd6,_0x1b37e2:0xb6},_0x4de8b7={_0x124d7c:0xdb,_0x123926:0xac,_0x43c0b2:0xcd,_0x453411:0x94},_0x595c90={_0x377814:0xbe},_0x19ce9d=_0x51509a,_0x3c5e49=this['_positions'],_0xa83e65=[];let _0x385ed2,_0x4a128b,_0xeb1590,_0x316ec9;_0x3c5e49['forEach'](_0x7ba624=>{const _0x57ff7d=_0x19e4,_0x4304d1=mars3d__namespace[_0x57ff7d(0xde)]['parse'](_0x7ba624);if(!_0x4304d1)return;_0x4304d1['value']=_0x7ba624[_0x57ff7d(_0x595c90._0x377814)]||0x1,!this['options']['rectangle']&&(_0x385ed2===undefined?(_0x385ed2=_0x4304d1['lng'],_0x4a128b=_0x4304d1['lng'],_0xeb1590=_0x4304d1['lat'],_0x316ec9=_0x4304d1[_0x57ff7d(0x9f)]):(_0x385ed2=Math['min'](_0x385ed2,_0x4304d1['lng']),_0x4a128b=Math['max'](_0x4a128b,_0x4304d1['lng']),_0xeb1590=Math['min'](_0xeb1590,_0x4304d1[_0x57ff7d(0x9f)]),_0x316ec9=Math['max'](_0x316ec9,_0x4304d1['lat']))),_0xa83e65['push'](_0x4304d1);});_0x385ed2===_0x4a128b&&(_0x385ed2-=0.000001,_0x4a128b+=0.000001);_0xeb1590===_0x316ec9&&(_0xeb1590-=0.000001,_0x316ec9+=0.000001);let _0x30f013=this['options']['rectangle']||{'xmin':_0x385ed2,'xmax':_0x4a128b,'ymin':_0xeb1590,'ymax':_0x316ec9};const _0x5c7b31=getMercatorBounds(_0x30f013),_0xb61396=Math['abs'](_0x5c7b31['xmax']-_0x5c7b31['xmin']),_0x1848fc=Math[_0x19ce9d(_0x1f967f._0x43b8a0)](_0x5c7b31['ymax']-_0x5c7b31['ymin']),_0x470f51=Math['max'](_0xb61396,_0x1848fc),_0x5b6aa7=Math['min'](_0xb61396,_0x1848fc);this['_mBoundsMax']=_0x470f51;let _0x28f59b=0x1;if(_0x470f51>this[_0x19ce9d(0xb5)]['maxCanvasSize'])_0x28f59b=_0x470f51/this['options']['maxCanvasSize'],_0x5b6aa7/_0x28f59b<this['options'][_0x19ce9d(_0x1f967f._0x597151)]&&(_0x28f59b=_0x5b6aa7/this['options']['minCanvasSize']);else _0x5b6aa7<this[_0x19ce9d(_0x1f967f._0x5a9946)]['minCanvasSize']&&(_0x28f59b=_0x5b6aa7/this['options'][_0x19ce9d(0xc1)],_0x470f51/_0x28f59b>this['options'][_0x19ce9d(_0x1f967f._0x2e2b37)]&&(_0x28f59b=_0x470f51/this['options']['maxCanvasSize']));const _0x2a59d1=this['heatStyle'][_0x19ce9d(_0x1f967f._0x251ea4)]*1.5,_0x7251d4=_0xb61396/_0x28f59b+_0x2a59d1*0x2,_0x114522=_0x1848fc/_0x28f59b+_0x2a59d1*0x2,_0x47e71f=_0x2a59d1*_0x28f59b;_0x5c7b31['xmin']-=_0x47e71f,_0x5c7b31['ymin']-=_0x47e71f,_0x5c7b31['xmax']+=_0x47e71f,_0x5c7b31['ymax']+=_0x47e71f,this['_scale']=_0x28f59b,_0x30f013=geLatLngBounds(_0x5c7b31),this['_rectangle']=Cesium[_0x19ce9d(_0x1f967f._0x5b4012)]['fromDegrees'](_0x30f013['xmin'],_0x30f013['ymin'],_0x30f013[_0x19ce9d(_0x1f967f._0x864631)],_0x30f013['ymax']);let _0x5c7034=_0xa83e65[0x0]['value']??0x1,_0x1fad20=_0xa83e65[0x0][_0x19ce9d(_0x1f967f._0x56c19b)]??0x0;const _0x359335=[];_0xa83e65[_0x19ce9d(_0x1f967f._0x38700d)](_0x141f7d=>{const _0x13f6ad=_0x19ce9d,_0xe24636=mars3d__namespace[_0x13f6ad(_0x4de8b7._0x124d7c)][_0x13f6ad(0x86)]([_0x141f7d[_0x13f6ad(_0x4de8b7._0x123926)],_0x141f7d['lat']]),_0x485830=_0x141f7d['value']||0x1,_0x465717=Math['round']((_0xe24636[0x0]-_0x5c7b31['xmin'])/_0x28f59b),_0x580512=Math[_0x13f6ad(_0x4de8b7._0x43c0b2)]((_0x5c7b31['ymax']-_0xe24636[0x1])/_0x28f59b);_0x5c7034=Math[_0x13f6ad(_0x4de8b7._0x453411)](_0x5c7034,_0x485830),_0x1fad20=Math[_0x13f6ad(0xcb)](_0x1fad20,_0x485830),_0x359335['push']({'x':_0x465717,'y':_0x580512,'value':_0x485830});});const _0x57fa58={'min':this['options']['min']??_0x1fad20,'max':this['options']['max']??_0x5c7034,'data':_0x359335};this['_last_heatData']=_0x57fa58;if(!this[_0x19ce9d(0xd6)]||_0x5c7b31['xmin']!==this['_last_mBounds']['xmin']||_0x5c7b31['ymin']!==this['_last_mBounds']['ymin']||_0x5c7b31['xmax']!==this[_0x19ce9d(_0x1f967f._0x47df77)]['xmax']||_0x5c7b31['ymax']!==this['_last_mBounds']['ymax']){this[_0x19ce9d(0xd6)]=_0x5c7b31,this[_0x19ce9d(0x8d)][_0x19ce9d(_0x1f967f._0x1b37e2)]['cssText']='width:'+_0x7251d4+'px;height:'+_0x114522+'px;';const _0x4ddb7f={...this['heatStyle'],'container':this['_container']};!this['_heat']?this['_heat']=h337__namespace['create'](_0x4ddb7f):this['_heat']['configure'](_0x4ddb7f);}this['_heat']['setData'](_0x57fa58);const _0x3837b8=mars3d__namespace['DomUtil']['copyCanvas'](this['_heat'][_0x19ce9d(0xbc)]['canvas']);return _0x3837b8;}[_0x51509a(0xd2)](){const _0x15179e={_0x13f6b0:0xc2,_0x31e554:0xb2,_0x4a1577:0xa0,_0x1058de:0xc5,_0x51547e:0xb5},_0x2477d2=_0x51509a;this[_0x2477d2(_0x15179e._0x13f6b0)]['configure']({'radius':this['heatStyle']['radius']*this['style'][_0x2477d2(_0x15179e._0x31e554)],'blur':this['heatStyle']['blur']*this['style']['arcBlurScale'],'gradient':this['heatStyle']['gradientArc']||{0.25:'rgb(0,0,0)',0.55:_0x2477d2(_0x15179e._0x4a1577),0.85:_0x2477d2(_0x15179e._0x1058de),0x1:_0x2477d2(0xcc)}});const _0x1de6da=mars3d__namespace['DomUtil']['copyCanvas'](this['_heat']['_renderer']['canvas']);return this['_heat']['configure'](this[_0x2477d2(_0x15179e._0x51547e)]['heatStyle']),_0x1de6da;}['getPointData'](_0x2448cd){const _0x6e6da7={_0x2543cc:0x9e,_0x5c4c41:0x86,_0x28da8b:0x93,_0x39303e:0xc9},_0x25779b=_0x51509a,_0x14a611=mars3d__namespace['LngLatPoint'][_0x25779b(_0x6e6da7._0x2543cc)](_0x2448cd);if(!_0x14a611)return{};const _0x7e6eef=mars3d__namespace['PointTrans'][_0x25779b(_0x6e6da7._0x5c4c41)]([_0x14a611['lng'],_0x14a611['lat']]),_0x5ba128=this['_last_mBounds'],_0x253c52=Math['round']((_0x7e6eef[0x0]-_0x5ba128[_0x25779b(_0x6e6da7._0x28da8b)])/this['_scale']),_0x3c2a2e=Math['round']((_0x5ba128[_0x25779b(_0x6e6da7._0x39303e)]-_0x7e6eef[0x1])/this[_0x25779b(0xda)]),_0x12d34e=this['_heat']['getValueAt']({'x':_0x253c52,'y':_0x3c2a2e}),_0x5c6fec=this['_heat']['_renderer']['ctx']['getImageData'](_0x253c52-0x1,_0x3c2a2e-0x1,0x1,0x1)['data'];return{'x':_0x253c52,'y':_0x3c2a2e,'value':_0x12d34e,'color':'rgba('+_0x5c6fec[0x0]+','+_0x5c6fec[0x1]+','+_0x5c6fec[0x2]+','+_0x5c6fec[0x3]+')'};}}mars3d__namespace[_0x51509a(0x9c)]['register'](_0x51509a(0xc8),HeatLayer),mars3d__namespace['layer']['HeatLayer']=HeatLayer,mars3d__namespace['h337']=h337__namespace;function getMercatorBounds(_0x5ecc2f){const _0x302530={_0x4534b3:0xdf},_0x3dbb34=_0x51509a,_0x4e61a3=mars3d__namespace['PointTrans']['lonlat2mercator']([_0x5ecc2f['xmin'],_0x5ecc2f['ymin']]),_0x23d96f=mars3d__namespace['PointTrans']['lonlat2mercator']([_0x5ecc2f[_0x3dbb34(_0x302530._0x4534b3)],_0x5ecc2f['ymax']]);return{'xmin':_0x4e61a3[0x0],'ymin':_0x4e61a3[0x1],'xmax':_0x23d96f[0x0],'ymax':_0x23d96f[0x1]};}function geLatLngBounds(_0x3b2b96){const _0x52ec4f={_0xd85fe4:0xa3},_0x283745=_0x51509a,_0x4952f6=mars3d__namespace['PointTrans']['mercator2lonlat']([_0x3b2b96['xmin'],_0x3b2b96[_0x283745(_0x52ec4f._0xd85fe4)]]),_0x281571=mars3d__namespace['PointTrans']['mercator2lonlat']([_0x3b2b96['xmax'],_0x3b2b96['ymax']]);return{'xmin':_0x4952f6[0x0],'ymin':_0x4952f6[0x1],'xmax':_0x281571[0x0],'ymax':_0x281571[0x1]};}function getVertexShaderSource(_0x2088e7){return'in\x20vec3\x20position3DHigh;\x0a\x20\x20in\x20vec3\x20position3DLow;\x0a\x20\x20in\x20vec2\x20st;\x0a\x20\x20in\x20float\x20batchId;\x0a\x20\x20uniform\x20sampler2D\x20bumpMap_3;\x0a\x20\x20out\x20vec3\x20v_positionMC;\x0a\x20\x20out\x20vec3\x20v_positionEC;\x0a\x20\x20out\x20vec2\x20v_st;\x0a\x0a\x20\x20void\x20main()\x0a\x20\x20{\x0a\x20\x20\x20\x20vec4\x20p\x20=\x20czm_computePosition();\x0a\x20\x20\x20\x20v_positionMC\x20=\x20position3DHigh\x20+\x20position3DLow;\x0a\x20\x20\x20\x20v_positionEC\x20=\x20(czm_modelViewRelativeToEye\x20*\x20p).xyz;\x0a\x20\x20\x20\x20v_st\x20=\x20st;\x0a\x20\x20\x20\x20vec4\x20color\x20=\x20texture(bumpMap_3,\x20v_st);\x0a\x20\x20\x20\x20float\x20centerBump\x20=\x20distance(vec3(0.0),color.rgb);\x0a\x20\x20\x20\x20vec3\x20upDir\x20=\x20normalize(v_positionMC.xyz);\x0a\x20\x20\x20\x20vec3\x20disPos\x20=\x20upDir\x20*\x20centerBump\x20*\x20'+_0x2088e7+';\x0a\x20\x20\x20\x20p\x20+=vec4(disPos,0.0);\x0a\x20\x20\x20\x20gl_Position\x20=\x20czm_modelViewProjectionRelativeToEye\x20*\x20p;\x0a\x20\x20}\x0a';}exports['HeatLayer']=HeatLayer,Object['defineProperty'](exports,'__esModule',{'value':!![]});
}));
