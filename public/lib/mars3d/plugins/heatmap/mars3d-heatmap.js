/**
 * Mars3D平台插件,结合heatmap可视化功能插件  mars3d-heatmap
 *
 * 版本信息：v3.6.11
 * 编译日期：2023-11-04 00:01:25
 * 版权所有：Copyright by 火星科技  http://mars3d.cn
 * 使用单位：免费公开版 ，2023-03-17
 */
(function (global, factory) {
  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, (window.mars3d || require('mars3d')), (window.h337 || require('@mars3d/heatmap.js'))) :
  typeof define === 'function' && define.amd ? define(['exports', 'mars3d', '@mars3d/heatmap.js'], factory) :
  (global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory(global["mars3d-heatmap"] = {}, global.mars3d, global.h337));
})(this, (function (exports, mars3d, h337) { 
'use strict';const _0x1f9678=_0x1f55;(function(_0xf7acea,_0x14f65a){const _0xac00df={_0xdf6f2f:0x99,_0xf48aa2:0x8c,_0xd7e682:0xa7,_0x15d168:0x85,_0x28c88c:0xbd,_0x5b6ae5:0x89,_0x3103db:0xcb,_0x1709fc:0x94},_0x2416cc=_0x1f55,_0x345ef4=_0xf7acea();while(!![]){try{const _0x520dda=parseInt(_0x2416cc(_0xac00df._0xdf6f2f))/0x1+-parseInt(_0x2416cc(_0xac00df._0xf48aa2))/0x2+parseInt(_0x2416cc(_0xac00df._0xd7e682))/0x3+parseInt(_0x2416cc(_0xac00df._0x15d168))/0x4*(parseInt(_0x2416cc(0xc5))/0x5)+parseInt(_0x2416cc(0x90))/0x6*(parseInt(_0x2416cc(_0xac00df._0x28c88c))/0x7)+parseInt(_0x2416cc(_0xac00df._0x5b6ae5))/0x8*(-parseInt(_0x2416cc(0x9c))/0x9)+-parseInt(_0x2416cc(_0xac00df._0x3103db))/0xa*(parseInt(_0x2416cc(_0xac00df._0x1709fc))/0xb);if(_0x520dda===_0x14f65a)break;else _0x345ef4['push'](_0x345ef4['shift']());}catch(_0x273aca){_0x345ef4['push'](_0x345ef4['shift']());}}}(_0xf1c4,0x3380b));function _0x1f55(_0x37613d,_0x4f144d){const _0xf1c49b=_0xf1c4();return _0x1f55=function(_0x1f55c1,_0x1da00d){_0x1f55c1=_0x1f55c1-0x80;let _0x2b409c=_0xf1c49b[_0x1f55c1];return _0x2b409c;},_0x1f55(_0x37613d,_0x4f144d);}function _interopNamespace(_0x449242){const _0x45d3f7={_0x2786c9:0xbc,_0x174bb4:0xb8},_0x592a7a=_0x1f55;if(_0x449242&&_0x449242['__esModule'])return _0x449242;var _0x1b3626=Object['create'](null);return _0x449242&&Object['keys'](_0x449242)[_0x592a7a(_0x45d3f7._0x2786c9)](function(_0x43bfcc){if(_0x43bfcc!=='default'){var _0x2373d6=Object['getOwnPropertyDescriptor'](_0x449242,_0x43bfcc);Object['defineProperty'](_0x1b3626,_0x43bfcc,_0x2373d6['get']?_0x2373d6:{'enumerable':!![],'get':function(){return _0x449242[_0x43bfcc];}});}}),_0x1b3626[_0x592a7a(_0x45d3f7._0x174bb4)]=_0x449242,_0x1b3626;}var mars3d__namespace=_interopNamespace(mars3d),h337__namespace=_interopNamespace(h337),HeatMaterial=_0x1f9678(0x9f);if(!h337__namespace['create'])throw new Error('请引入\x20heatmap.js\x20库\x20');const Cesium=mars3d__namespace[_0x1f9678(0xab)],BaseLayer=mars3d__namespace['layer']['BaseLayer'],DEF_HEATSTYLE={'maxOpacity':0.8,'minOpacity':0.1,'blur':0.85,'radius':0x19,'gradient':{0.4:'blue',0.6:'green',0.8:_0x1f9678(0xd3),0.9:'red'}},DEF_STYLE={'arcRadiusScale':1.5,'arcBlurScale':1.5,'vertexFormat':Cesium['EllipsoidSurfaceAppearance']['VERTEX_FORMAT']};class HeatLayer extends BaseLayer{constructor(_0x13dc49={}){const _0x15576d={_0x1ce4c1:0xb5,_0x4727ae:0x81,_0x8bf0e3:0xb0,_0x3a9e3a:0x81,_0x69dfad:0x81,_0x3a6ba2:0x81},_0x713d8d=_0x1f9678;super(_0x13dc49),this['options']['maxCanvasSize']=this['options']['maxCanvasSize']??document['body'][_0x713d8d(_0x15576d._0x1ce4c1)],this[_0x713d8d(_0x15576d._0x4727ae)][_0x713d8d(_0x15576d._0x8bf0e3)]=Math['min'](this['options']['maxCanvasSize'],0x1388),this['options'][_0x713d8d(0xb7)]=this['options']['minCanvasSize']??document['body']['clientHeight'],this[_0x713d8d(_0x15576d._0x3a9e3a)][_0x713d8d(0xb7)]=Math['max'](this['options']['minCanvasSize'],0x2bc),this[_0x713d8d(_0x15576d._0x69dfad)]['heatStyle']={...DEF_HEATSTYLE,...this[_0x713d8d(_0x15576d._0x3a6ba2)]['heatStyle']},this['options']['style']={...DEF_STYLE,...this['options'][_0x713d8d(0x80)]};}get['layer'](){const _0x47f8b6=_0x1f9678;return this[_0x47f8b6(0x96)];}get['heatStyle'](){const _0x2f12ef={_0x345b44:0x81},_0x2e6e93=_0x1f9678;return this[_0x2e6e93(_0x2f12ef._0x345b44)]['heatStyle'];}set['heatStyle'](_0x6df914){this['options']['heatStyle']=mars3d__namespace['Util']['merge'](this['options']['heatStyle'],_0x6df914),this['_heat']&&(this['_heat']['configure'](this['options']['heatStyle']),this['_updatePositionsHook'](!![]));}get['style'](){return this['options']['style'];}set['style'](_0x24058c){const _0x57e78f={_0x275b8a:0x81},_0x212486=_0x1f9678;this[_0x212486(_0x57e78f._0x275b8a)]['style']=mars3d__namespace['Util']['merge'](this['options']['style'],_0x24058c);}get['positions'](){return this['_positions'];}set[_0x1f9678(0x8f)](_0x320e68){this['setPositions'](_0x320e68);}get['coordinates'](){const _0x56d071={_0x36d865:0xbc},_0x5959a6={_0x1e41cc:0x87},_0x1ba494=_0x1f9678,_0xdefd63=[];return this['points'][_0x1ba494(_0x56d071._0x36d865)](_0x47e67b=>{const _0x43b77e=_0x1ba494;_0xdefd63['push'](_0x47e67b[_0x43b77e(_0x5959a6._0x1e41cc)]());}),_0xdefd63;}get[_0x1f9678(0xba)](){return this['_rectangle'];}['_setOptionsHook'](_0x17ed36,_0x49b010){const _0x2ca3d0={_0x4ddc49:0x8f},_0x22deb7=_0x1f9678;_0x17ed36['positions']&&(this[_0x22deb7(_0x2ca3d0._0x4ddc49)]=_0x17ed36['positions']);}['_mountedHook'](){const _0x25fe38={_0x34cdb7:0xd6},_0x140db5=_0x1f9678;this['style']['type']==='image'?this['_layer']=new mars3d__namespace[(_0x140db5(_0x25fe38._0x34cdb7))]['ImageLayer']({'crs':'EPSG:3857','private':!![]}):this['_layer']=new mars3d__namespace['layer']['GraphicLayer']({'private':!![]});}['_addedHook'](){const _0x24c25b={_0x143a80:0xc2,_0x9d2d9b:0xc4,_0x5e7cc0:0xc0,_0x24f9d4:0x81,_0x38f4c6:0x81},_0x5c1ac7=_0x1f9678;this['_map']['addLayer'](this[_0x5c1ac7(0x96)]),this[_0x5c1ac7(_0x24c25b._0x143a80)]=mars3d__namespace[_0x5c1ac7(0xc9)][_0x5c1ac7(_0x24c25b._0x9d2d9b)]('div','mars3d-heatmap\x20mars3d-hideDiv',this[_0x5c1ac7(_0x24c25b._0x5e7cc0)]['container']),this['options']['positions']&&(this['positions']=this[_0x5c1ac7(_0x24c25b._0x24f9d4)]['positions']),this[_0x5c1ac7(_0x24c25b._0x38f4c6)]['flyTo']&&this['flyToByAnimationEnd']();}[_0x1f9678(0xad)](){const _0x55bea4={_0x46619:0xbf},_0x5e6935=_0x1f9678;this['_container']&&(mars3d__namespace['DomUtil']['remove'](this['_container']),delete this['_container']),this['clear'](),this[_0x5e6935(0xc0)][_0x5e6935(_0x55bea4._0x46619)](this[_0x5e6935(0x96)]);}['addPosition'](_0x44d158,_0x599a91){const _0x242511=_0x1f9678;this[_0x242511(0x8b)]=this['_positions']||[],this['_positions']['push'](_0x44d158),this['_updatePositionsHook'](_0x599a91);}['setPositions'](_0x18e4b3,_0x3b4acc){const _0x349500={_0x271ee2:0x8b,_0xcab88b:0xc3},_0x2136df=_0x1f9678;this[_0x2136df(_0x349500._0x271ee2)]=_0x18e4b3,this[_0x2136df(_0x349500._0xcab88b)](_0x3b4acc);}['clear'](){const _0x4fcb8b={_0x4dec47:0x96,_0x5b3a48:0xb6},_0x43a145=_0x1f9678;this['_graphic']&&(this[_0x43a145(_0x4fcb8b._0x4dec47)]['removeGraphic'](this['_graphic'],!![]),delete this[_0x43a145(_0x4fcb8b._0x5b3a48)]),this['_graphic2']&&(this[_0x43a145(0x96)]['removeGraphic'](this['_graphic2'],!![]),delete this['_graphic2']);}[_0x1f9678(0xc3)](_0x3a9463){const _0x3fe01d={_0x54d8ae:0x8f,_0x4e3f85:0xa8,_0x432c1f:0xb6,_0x2ca5e8:0xa5},_0x347e8c=_0x1f9678;if(!this['show']||!this['_map']||!this['positions']||this[_0x347e8c(_0x3fe01d._0x54d8ae)]['length']===0x0)return this;const _0x43e366=this[_0x347e8c(0xbe)]();if(this[_0x347e8c(0x80)]['type']===_0x347e8c(_0x3fe01d._0x4e3f85))this[_0x347e8c(0x96)]['setOptions']({'url':_0x43e366['toDataURL'](_0x347e8c(0xa1)),'rectangle':this[_0x347e8c(0xca)],'opacity':this['style']['opacity']});else this['style']['arc']?this[_0x347e8c(_0x3fe01d._0x432c1f)]&&_0x3a9463?(this['_graphic'][_0x347e8c(_0x3fe01d._0x2ca5e8)]['image']=_0x43e366,this['_graphic']['uniforms'][_0x347e8c(0xa6)]=this['_getArcHeatCanvas'](),this['_graphic2']&&(this['_graphic2']['uniforms'][_0x347e8c(0xa8)]=_0x43e366,this[_0x347e8c(0xd5)]['uniforms']['bumpMap']=this['_graphic']['uniforms']['bumpMap'])):this['_createArcGraphic'](_0x43e366):this['_graphic']&&_0x3a9463?this['_graphic']['uniforms'][_0x347e8c(0xa8)]=_0x43e366:this['_createGraphic'](_0x43e366);return this;}[_0x1f9678(0xd1)](_0x2c049c){const _0x34c5fb=_0x1f9678;this['clear'](),this['_graphic']=new mars3d__namespace['graphic']['RectanglePrimitive']({...this['options'],'rectangle':this['_rectangle'],'appearance':new Cesium['EllipsoidSurfaceAppearance']({'material':new Cesium['Material']({'fabric':{'uniforms':{'image':_0x2c049c},'source':HeatMaterial},'translucent':!![]}),'flat':!![]})}),this[_0x34c5fb(0x96)]['addGraphic'](this['_graphic']);}['_createArcGraphic'](_0x107ca9){const _0x131838={_0x491103:0xc8,_0x58b3f0:0x80,_0x2f3e39:0xa0,_0x2e0b3b:0xca},_0x3a683f=_0x1f9678;this['clear']();const _0x3ed247=Cesium['RenderState'][_0x3a683f(0xae)]({'cull':{'enabled':!![]},'depthTest':{'enabled':!![]},'stencilTest':{'enabled':!![],'frontFunction':Cesium['StencilFunction']['ALWAYS'],'frontOperation':{'fail':Cesium[_0x3a683f(_0x131838._0x491103)][_0x3a683f(0xc6)],'zFail':Cesium['StencilOperation']['KEEP'],'zPass':Cesium['StencilOperation']['REPLACE']},'backFunction':Cesium['StencilFunction']['ALWAYS'],'backOperation':{'fail':Cesium['StencilOperation']['KEEP'],'zFail':Cesium['StencilOperation']['KEEP'],'zPass':Cesium[_0x3a683f(0xc8)][_0x3a683f(0xce)]},'reference':0x2,'mask':0x2},'blending':Cesium[_0x3a683f(0x86)][_0x3a683f(0xd2)]}),_0x415a2c=Math[_0x3a683f(0xb3)](this[_0x3a683f(_0x131838._0x58b3f0)]['diffHeight']??this['_mBoundsMax']*0.02)+0.1;this['style']['diffHeight']&&delete this['style']['diffHeight'];const _0x20fd73=(this['style']['splitNum'],0x64);let _0x2be60c=Math['max'](this[_0x3a683f(0xca)]['height'],this['_rectangle']['width']);this['style']['granularity']=_0x2be60c/=_0x20fd73;const _0x34289c=new Cesium['Material']({'fabric':{'uniforms':{'image':_0x107ca9,'repeat':new Cesium[(_0x3a683f(0xb4))](0x1,0x1),'color':new Cesium['Color'](0x1,0x1,0x1,0x0),'bumpMap':this[_0x3a683f(0x9a)]()},'source':HeatMaterial},'translucent':!![]}),_0x4639ed=this['style']['arcDirection']||0x1;this['_graphic']=new mars3d__namespace['graphic'][(_0x3a683f(_0x131838._0x2f3e39))]({...this['options'],'rectangle':this[_0x3a683f(_0x131838._0x2e0b3b)],'appearance':new Cesium['EllipsoidSurfaceAppearance']({'flat':!![],'aboveGround':!![],'renderState':_0x3ed247,'material':_0x34289c,'vertexShaderSource':getVertexShaderSource(_0x415a2c*_0x4639ed)})}),this['_layer']['addGraphic'](this['_graphic']),this[_0x3a683f(0x80)]['arcDirection']===0x0&&(this['_graphic2']=new mars3d__namespace['graphic'][(_0x3a683f(0xa0))]({...this['options'],'rectangle':this[_0x3a683f(0xca)],'appearance':new Cesium['EllipsoidSurfaceAppearance']({'flat':!![],'aboveGround':!![],'renderState':_0x3ed247,'material':_0x34289c,'vertexShaderSource':getVertexShaderSource(-_0x415a2c)})}),this['_layer']['addGraphic'](this['_graphic2']));}['getRectangle'](_0x112583){const _0x233023={_0x1c2a57:0xd0},_0x33b3b6=_0x1f9678;return _0x112583!==null&&_0x112583!==void 0x0&&_0x112583[_0x33b3b6(_0x233023._0x1c2a57)]&&this['_rectangle']?mars3d__namespace['PolyUtil']['formatRectangle'](this['_rectangle']):this['_rectangle'];}[_0x1f9678(0xbe)](){const _0xce0d33={_0x1cb1e9:0xbb,_0x29761e:0xcf,_0x2ae834:0x81,_0x1db38d:0xb7,_0x50037b:0x81,_0x40090e:0xb7,_0x19f948:0x8e,_0x2b0997:0x81,_0x87a59f:0xbb,_0x4bfcaf:0xc2,_0x2e6394:0xa2,_0x223315:0xc4,_0x4e6f41:0x82,_0x7ec17:0xc9},_0x1af504={_0x240f39:0x97,_0x3755c1:0x8a},_0x3b4be2={_0x22e4fa:0xcc,_0x58093c:0x9e,_0x55bfac:0xd4},_0x5b8f48=_0x1f9678,_0x28f385=this['_positions'],_0x189e89=[];let _0x2dbb08,_0x5285e,_0x32d01a,_0x2f560e;_0x28f385['forEach'](_0x1ae701=>{const _0x3cf1c2=_0x1f55,_0x3c6241=mars3d__namespace[_0x3cf1c2(_0x3b4be2._0x22e4fa)][_0x3cf1c2(_0x3b4be2._0x58093c)](_0x1ae701);if(!_0x3c6241)return;_0x3c6241['value']=_0x1ae701[_0x3cf1c2(0x97)]||0x1,!this['options']['rectangle']&&(_0x2dbb08===undefined?(_0x2dbb08=_0x3c6241['lng'],_0x5285e=_0x3c6241[_0x3cf1c2(0xd4)],_0x32d01a=_0x3c6241['lat'],_0x2f560e=_0x3c6241[_0x3cf1c2(0x95)]):(_0x2dbb08=Math['min'](_0x2dbb08,_0x3c6241['lng']),_0x5285e=Math['max'](_0x5285e,_0x3c6241[_0x3cf1c2(_0x3b4be2._0x55bfac)]),_0x32d01a=Math[_0x3cf1c2(0x8a)](_0x32d01a,_0x3c6241['lat']),_0x2f560e=Math['max'](_0x2f560e,_0x3c6241['lat']))),_0x189e89[_0x3cf1c2(0x88)](_0x3c6241);});_0x2dbb08===_0x5285e&&(_0x2dbb08-=0.000001,_0x5285e+=0.000001);_0x32d01a===_0x2f560e&&(_0x32d01a-=0.000001,_0x2f560e+=0.000001);let _0x23a1a8=this['options']['rectangle']||{'xmin':_0x2dbb08,'xmax':_0x5285e,'ymin':_0x32d01a,'ymax':_0x2f560e};const _0x13320e=getMercatorBounds(_0x23a1a8),_0x1cf54e=Math['abs'](_0x13320e['xmax']-_0x13320e[_0x5b8f48(_0xce0d33._0x1cb1e9)]),_0x5ae4b9=Math['abs'](_0x13320e['ymax']-_0x13320e[_0x5b8f48(_0xce0d33._0x29761e)]),_0x12ed1a=Math[_0x5b8f48(0xaf)](_0x1cf54e,_0x5ae4b9),_0xcc0d75=Math[_0x5b8f48(0x8a)](_0x1cf54e,_0x5ae4b9);this['_mBoundsMax']=_0x12ed1a;let _0x4062eb=0x1;if(_0x12ed1a>this[_0x5b8f48(_0xce0d33._0x2ae834)]['maxCanvasSize'])_0x4062eb=_0x12ed1a/this['options'][_0x5b8f48(0xb0)],_0xcc0d75/_0x4062eb<this['options'][_0x5b8f48(_0xce0d33._0x1db38d)]&&(_0x4062eb=_0xcc0d75/this[_0x5b8f48(_0xce0d33._0x50037b)][_0x5b8f48(_0xce0d33._0x40090e)]);else _0xcc0d75<this['options']['minCanvasSize']&&(_0x4062eb=_0xcc0d75/this['options']['minCanvasSize'],_0x12ed1a/_0x4062eb>this['options']['maxCanvasSize']&&(_0x4062eb=_0x12ed1a/this['options']['maxCanvasSize']));const _0x403752=this['heatStyle'][_0x5b8f48(_0xce0d33._0x19f948)]*1.5,_0x204133=_0x1cf54e/_0x4062eb+_0x403752*0x2,_0x93fb78=_0x5ae4b9/_0x4062eb+_0x403752*0x2,_0x4cb5d3=_0x403752*_0x4062eb;_0x13320e[_0x5b8f48(0xbb)]-=_0x4cb5d3,_0x13320e['ymin']-=_0x4cb5d3,_0x13320e['xmax']+=_0x4cb5d3,_0x13320e['ymax']+=_0x4cb5d3,this['_scale']=_0x4062eb,_0x23a1a8=geLatLngBounds(_0x13320e),this['_rectangle']=Cesium[_0x5b8f48(0xcd)]['fromDegrees'](_0x23a1a8['xmin'],_0x23a1a8['ymin'],_0x23a1a8['xmax'],_0x23a1a8['ymax']);let _0x117bdc=_0x189e89[0x0][_0x5b8f48(0x97)]??0x1,_0x43fd2a=_0x189e89[0x0]['value']??0x0;const _0x12075f=[];_0x189e89['forEach'](_0x163bce=>{const _0x2b0e2c=_0x5b8f48,_0x5a35d0=mars3d__namespace[_0x2b0e2c(0xa3)]['lonlat2mercator']([_0x163bce['lng'],_0x163bce['lat']]),_0x42480c=_0x163bce[_0x2b0e2c(_0x1af504._0x240f39)]||0x1,_0x5ae525=Math['round']((_0x5a35d0[0x0]-_0x13320e['xmin'])/_0x4062eb),_0x59e6c2=Math['round']((_0x13320e['ymax']-_0x5a35d0[0x1])/_0x4062eb);_0x117bdc=Math['max'](_0x117bdc,_0x42480c),_0x43fd2a=Math[_0x2b0e2c(_0x1af504._0x3755c1)](_0x43fd2a,_0x42480c),_0x12075f['push']({'x':_0x5ae525,'y':_0x59e6c2,'value':_0x42480c});});const _0x23fe3a={'min':this['options']['min']??_0x43fd2a,'max':this[_0x5b8f48(_0xce0d33._0x2b0997)]['max']??_0x117bdc,'data':_0x12075f};this[_0x5b8f48(0xaa)]=_0x23fe3a;if(!this['_last_mBounds']||_0x13320e['xmin']!==this['_last_mBounds'][_0x5b8f48(_0xce0d33._0x87a59f)]||_0x13320e[_0x5b8f48(_0xce0d33._0x29761e)]!==this[_0x5b8f48(0xa4)][_0x5b8f48(_0xce0d33._0x29761e)]||_0x13320e['xmax']!==this[_0x5b8f48(0xa4)]['xmax']||_0x13320e['ymax']!==this['_last_mBounds']['ymax']){this['_last_mBounds']=_0x13320e,this['_container']['style']['cssText']='width:'+_0x204133+'px;height:'+_0x93fb78+'px;';const _0x397acc={...this[_0x5b8f48(0x92)],'container':this[_0x5b8f48(_0xce0d33._0x4bfcaf)]};!this[_0x5b8f48(0xa2)]?this[_0x5b8f48(_0xce0d33._0x2e6394)]=h337__namespace[_0x5b8f48(_0xce0d33._0x223315)](_0x397acc):this[_0x5b8f48(0xa2)]['configure'](_0x397acc);}this['_heat'][_0x5b8f48(_0xce0d33._0x4e6f41)](_0x23fe3a);const _0x4621d4=mars3d__namespace[_0x5b8f48(_0xce0d33._0x7ec17)]['copyCanvas'](this['_heat']['_renderer']['canvas']);return _0x4621d4;}['_getArcHeatCanvas'](){const _0x308a0d={_0x535e17:0x92,_0x57dbfa:0x80,_0x356e63:0x80,_0x380c8b:0x84,_0x188268:0x9d,_0x4fd886:0xb2,_0x3adf8:0xa2},_0x80d9d1=_0x1f9678;this[_0x80d9d1(0xa2)]['configure']({'radius':this[_0x80d9d1(_0x308a0d._0x535e17)]['radius']*this[_0x80d9d1(_0x308a0d._0x57dbfa)]['arcRadiusScale'],'blur':this['heatStyle']['blur']*this[_0x80d9d1(_0x308a0d._0x356e63)][_0x80d9d1(0x98)],'gradient':this['heatStyle'][_0x80d9d1(_0x308a0d._0x380c8b)]||{0.25:'rgb(0,0,0)',0.55:'rgb(140,140,140)',0.85:_0x80d9d1(_0x308a0d._0x188268),0x1:_0x80d9d1(0xa9)}});const _0x3d9047=mars3d__namespace['DomUtil'][_0x80d9d1(_0x308a0d._0x4fd886)](this[_0x80d9d1(_0x308a0d._0x3adf8)]['_renderer']['canvas']);return this['_heat']['configure'](this['options']['heatStyle']),_0x3d9047;}['getPointData'](_0x325af9){const _0x4569bf={_0x2d3a18:0x93},_0x4a76e6=_0x1f9678,_0x57594f=mars3d__namespace['LngLatPoint']['parse'](_0x325af9);if(!_0x57594f)return{};const _0x20fdee=mars3d__namespace[_0x4a76e6(0xa3)][_0x4a76e6(0x83)]([_0x57594f['lng'],_0x57594f['lat']]),_0x25359b=this[_0x4a76e6(0xa4)],_0x442f3a=Math[_0x4a76e6(_0x4569bf._0x2d3a18)]((_0x20fdee[0x0]-_0x25359b['xmin'])/this['_scale']),_0x51806a=Math['round']((_0x25359b['ymax']-_0x20fdee[0x1])/this[_0x4a76e6(0xac)]),_0x499507=this['_heat']['getValueAt']({'x':_0x442f3a,'y':_0x51806a}),_0x4cc832=this['_heat']['_renderer']['ctx']['getImageData'](_0x442f3a-0x1,_0x51806a-0x1,0x1,0x1)[_0x4a76e6(0x9b)];return{'x':_0x442f3a,'y':_0x51806a,'value':_0x499507,'color':'rgba('+_0x4cc832[0x0]+','+_0x4cc832[0x1]+','+_0x4cc832[0x2]+','+_0x4cc832[0x3]+')'};}}mars3d__namespace[_0x1f9678(0x8d)]['register']('heat',HeatLayer),mars3d__namespace[_0x1f9678(0xd6)]['HeatLayer']=HeatLayer,mars3d__namespace[_0x1f9678(0xc1)]=h337__namespace;function getMercatorBounds(_0x3f6231){const _0x128bea={_0x44f9c5:0xa3,_0x187c9d:0xb9},_0x18a4b1=_0x1f9678,_0x912e04=mars3d__namespace[_0x18a4b1(_0x128bea._0x44f9c5)]['lonlat2mercator']([_0x3f6231['xmin'],_0x3f6231['ymin']]),_0x5cce39=mars3d__namespace['PointTrans']['lonlat2mercator']([_0x3f6231[_0x18a4b1(_0x128bea._0x187c9d)],_0x3f6231[_0x18a4b1(0xb1)]]);return{'xmin':_0x912e04[0x0],'ymin':_0x912e04[0x1],'xmax':_0x5cce39[0x0],'ymax':_0x5cce39[0x1]};}function _0xf1c4(){const _0x3830a1=['_scale','_removedHook','fromCache','max','maxCanvasSize','ymax','copyCanvas','floor','Cartesian2','clientWidth','_graphic','minCanvasSize','default','xmax','rectangle','xmin','forEach','49IMErpa','_getHeatCanvas','removeLayer','_map','h337','_container','_updatePositionsHook','create','695xETLuF','KEEP','mercator2lonlat','StencilOperation','DomUtil','_rectangle','10FCbvQU','LngLatPoint','Rectangle','REPLACE','ymin','isFormat','_createGraphic','ALPHA_BLEND','yellow','lng','_graphic2','layer','style','options','setData','lonlat2mercator','gradientArc','6052qqAUco','BlendingState','toArray','push','847480RKJWgT','min','_positions','688338ePEHOb','LayerUtil','radius','positions','342222KKeDVF','__esModule','heatStyle','round','2710202TfZiBj','lat','_layer','value','arcBlurScale','101899sIxMEU','_getArcHeatCanvas','data','27FmIJUZ','rgb(216,216,216)','parse','uniform\x20sampler2D\x20image;\x0a\x0aczm_material\x20czm_getMaterial(czm_materialInput\x20materialInput)\x20{\x0a\x20\x20czm_material\x20material\x20=\x20czm_getDefaultMaterial(materialInput);\x0a\x20\x20vec2\x20st\x20=\x20materialInput.st;\x0a\x20\x20vec4\x20colorImage\x20=\x20texture(image,\x20st);\x0a\x20\x20if(colorImage.rgb\x20==\x20vec3(1.0)\x20||\x20colorImage.rgb\x20==\x20vec3(0.0))\x20{\x0a\x20\x20\x20\x20discard;\x0a\x20\x20}\x0a\x20\x20material.diffuse\x20=\x20colorImage.rgb;\x0a\x20\x20material.alpha\x20=\x20colorImage.a;\x0a\x20\x20return\x20material;\x0a}\x0a','RectanglePrimitive','image/png','_heat','PointTrans','_last_mBounds','uniforms','bumpMap','1223538oPsOsD','image','rgb(255,255,255)','_last_heatData','Cesium'];_0xf1c4=function(){return _0x3830a1;};return _0xf1c4();}function geLatLngBounds(_0x557d20){const _0x48481d=_0x1f9678,_0x6286cf=mars3d__namespace['PointTrans'][_0x48481d(0xc7)]([_0x557d20[_0x48481d(0xbb)],_0x557d20['ymin']]),_0x48ffd1=mars3d__namespace[_0x48481d(0xa3)]['mercator2lonlat']([_0x557d20['xmax'],_0x557d20['ymax']]);return{'xmin':_0x6286cf[0x0],'ymin':_0x6286cf[0x1],'xmax':_0x48ffd1[0x0],'ymax':_0x48ffd1[0x1]};}function getVertexShaderSource(_0x18b032){return'in\x20vec3\x20position3DHigh;\x0a\x20\x20in\x20vec3\x20position3DLow;\x0a\x20\x20in\x20vec2\x20st;\x0a\x20\x20in\x20float\x20batchId;\x0a\x20\x20uniform\x20sampler2D\x20bumpMap_3;\x0a\x20\x20out\x20vec3\x20v_positionMC;\x0a\x20\x20out\x20vec3\x20v_positionEC;\x0a\x20\x20out\x20vec2\x20v_st;\x0a\x0a\x20\x20void\x20main()\x0a\x20\x20{\x0a\x20\x20\x20\x20vec4\x20p\x20=\x20czm_computePosition();\x0a\x20\x20\x20\x20v_positionMC\x20=\x20position3DHigh\x20+\x20position3DLow;\x0a\x20\x20\x20\x20v_positionEC\x20=\x20(czm_modelViewRelativeToEye\x20*\x20p).xyz;\x0a\x20\x20\x20\x20v_st\x20=\x20st;\x0a\x20\x20\x20\x20vec4\x20color\x20=\x20texture(bumpMap_3,\x20v_st);\x0a\x20\x20\x20\x20float\x20centerBump\x20=\x20distance(vec3(0.0),color.rgb);\x0a\x20\x20\x20\x20vec3\x20upDir\x20=\x20normalize(v_positionMC.xyz);\x0a\x20\x20\x20\x20vec3\x20disPos\x20=\x20upDir\x20*\x20centerBump\x20*\x20'+_0x18b032+';\x0a\x20\x20\x20\x20p\x20+=vec4(disPos,0.0);\x0a\x20\x20\x20\x20gl_Position\x20=\x20czm_modelViewProjectionRelativeToEye\x20*\x20p;\x0a\x20\x20}\x0a';}exports['HeatLayer']=HeatLayer,Object['defineProperty'](exports,_0x1f9678(0x91),{'value':!![]});
}));
