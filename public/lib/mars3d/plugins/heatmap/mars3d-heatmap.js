/**
 * Mars3D平台插件,结合heatmap可视化功能插件  mars3d-heatmap
 *
 * 版本信息：v3.6.4
 * 编译日期：2023-09-05 14:31:23
 * 版权所有：Copyright by 火星科技  http://mars3d.cn
 * 使用单位：免费公开版 ，2023-03-17
 */
(function (global, factory) {
  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, (window.mars3d || require('mars3d')), (window.h337 || require('@mars3d/heatmap.js'))) :
  typeof define === 'function' && define.amd ? define(['exports', 'mars3d', '@mars3d/heatmap.js'], factory) :
  (global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory(global["mars3d-heatmap"] = {}, global.mars3d, global.h337));
})(this, (function (exports, mars3d, h337) { 
'use strict';const _0x5c0905=_0xa96c;function _0x2edc(){const _0x9bb389=['px;height:','image','lng','Material','_getArcHeatCanvas','default','copyCanvas','maxCanvasSize','LayerUtil','flyToByAnimationEnd','3192927tKJQyR','4354VBiSQE','rectangle','51652yeakTv','rgb(0,0,0)','create','_last_mBounds','398ukfoOi','EllipsoidSurfaceAppearance','getImageData','_renderer','HeatLayer','ImageLayer','_graphic','value','heatStyle','_updatePositionsHook','removeGraphic','points','mars3d-heatmap\x20mars3d-hideDiv','_container','max','clear','addLayer','ymin','isFormat','minCanvasSize','506051ZvmbtJ','parse','_graphic2','_rectangle','clientHeight','34007510FnTBZp','style','ymax','_heat','floor','8nZqWtN','xmin','_layer','_scale','5HeOjgZ','layer','round','rgb(255,255,255)','forEach','54423UbozeY','_createGraphic','xmax','rgb(140,140,140)','splitNum','_positions','lat','opacity','addGraphic','coordinates','DomUtil','options','Util','graphic','positions','PointTrans','bumpMap','KEEP','fromCache','4482462OeqhYG','blur','push','green','RectanglePrimitive','uniforms','_map','PolyUtil','BlendingState','diffHeight','removeLayer'];_0x2edc=function(){return _0x9bb389;};return _0x2edc();}(function(_0x4f4619,_0x5ad922){const _0x21b84a={_0x497f86:0x1d7,_0x5d52f7:0x200,_0x5703db:0x218,_0x10dbb5:0x1fc,_0x14ec9f:0x1f7},_0x402a2b=_0xa96c,_0xbc1935=_0x4f4619();while(!![]){try{const _0x408a3d=parseInt(_0x402a2b(0x1de))/0x1*(-parseInt(_0x402a2b(0x1d8))/0x2)+-parseInt(_0x402a2b(_0x21b84a._0x497f86))/0x3+parseInt(_0x402a2b(0x1da))/0x4+-parseInt(_0x402a2b(_0x21b84a._0x5d52f7))/0x5*(parseInt(_0x402a2b(_0x21b84a._0x5703db))/0x6)+-parseInt(_0x402a2b(0x1f2))/0x7+-parseInt(_0x402a2b(_0x21b84a._0x10dbb5))/0x8*(parseInt(_0x402a2b(0x205))/0x9)+parseInt(_0x402a2b(_0x21b84a._0x14ec9f))/0xa;if(_0x408a3d===_0x5ad922)break;else _0xbc1935['push'](_0xbc1935['shift']());}catch(_0x34b24e){_0xbc1935['push'](_0xbc1935['shift']());}}}(_0x2edc,0xa0854));function _interopNamespace(_0x51f574){const _0x50530f=_0xa96c;if(_0x51f574&&_0x51f574['__esModule'])return _0x51f574;var _0x203d78=Object['create'](null);return _0x51f574&&Object['keys'](_0x51f574)[_0x50530f(0x204)](function(_0x40186f){const _0x26f9ef=_0x50530f;if(_0x40186f!==_0x26f9ef(0x1d2)){var _0x2e6ff4=Object['getOwnPropertyDescriptor'](_0x51f574,_0x40186f);Object['defineProperty'](_0x203d78,_0x40186f,_0x2e6ff4['get']?_0x2e6ff4:{'enumerable':!![],'get':function(){return _0x51f574[_0x40186f];}});}}),_0x203d78['default']=_0x51f574,_0x203d78;}var mars3d__namespace=_interopNamespace(mars3d),h337__namespace=_interopNamespace(h337),HeatMaterial='uniform\x20sampler2D\x20image;\x0a\x0aczm_material\x20czm_getMaterial(czm_materialInput\x20materialInput)\x20{\x0a\x20\x20czm_material\x20material\x20=\x20czm_getDefaultMaterial(materialInput);\x0a\x20\x20vec2\x20st\x20=\x20materialInput.st;\x0a\x20\x20vec4\x20colorImage\x20=\x20texture(image,\x20st);\x0a\x20\x20if(colorImage.rgb\x20==\x20vec3(1.0)\x20||\x20colorImage.rgb\x20==\x20vec3(0.0))\x20{\x0a\x20\x20\x20\x20discard;\x0a\x20\x20}\x0a\x20\x20material.diffuse\x20=\x20colorImage.rgb;\x0a\x20\x20material.alpha\x20=\x20colorImage.a;\x0a\x20\x20return\x20material;\x0a}\x0a';if(!h337__namespace[_0x5c0905(0x1dc)])throw new Error('请引入\x20heatmap.js\x20库\x20');const Cesium=mars3d__namespace['Cesium'],BaseLayer=mars3d__namespace[_0x5c0905(0x201)]['BaseLayer'],DEF_HEATSTYLE={'maxOpacity':0.8,'minOpacity':0.1,'blur':0.85,'radius':0x19,'gradient':{0.4:'blue',0.6:_0x5c0905(0x21b),0.8:'yellow',0.9:'red'}},DEF_STYLE={'arcRadiusScale':1.5,'arcBlurScale':1.5,'vertexFormat':Cesium[_0x5c0905(0x1df)]['VERTEX_FORMAT']};class HeatLayer extends BaseLayer{constructor(_0x56feb6={}){const _0x3a5c8e={_0xd7a11:0x210,_0x4357e9:0x1f6},_0x694f98=_0x5c0905;super(_0x56feb6),this['options']['maxCanvasSize']=this[_0x694f98(_0x3a5c8e._0xd7a11)]['maxCanvasSize']??document['body']['clientWidth'],this[_0x694f98(0x210)]['maxCanvasSize']=Math['min'](this[_0x694f98(_0x3a5c8e._0xd7a11)]['maxCanvasSize'],0x1388),this[_0x694f98(0x210)]['minCanvasSize']=this[_0x694f98(0x210)][_0x694f98(0x1f1)]??document['body'][_0x694f98(_0x3a5c8e._0x4357e9)],this[_0x694f98(0x210)]['minCanvasSize']=Math['max'](this[_0x694f98(_0x3a5c8e._0xd7a11)]['minCanvasSize'],0x2bc),this[_0x694f98(0x210)]['heatStyle']={...DEF_HEATSTYLE,...this[_0x694f98(0x210)][_0x694f98(0x1e6)]},this['options']['style']={...DEF_STYLE,...this[_0x694f98(_0x3a5c8e._0xd7a11)]['style']};}get['layer'](){return this['_layer'];}get['heatStyle'](){const _0x11cc1f={_0x1051c0:0x1e6},_0x3e350e=_0x5c0905;return this[_0x3e350e(0x210)][_0x3e350e(_0x11cc1f._0x1051c0)];}set['heatStyle'](_0x178b31){const _0xff090f=_0x5c0905;this['options']['heatStyle']=mars3d__namespace[_0xff090f(0x211)]['merge'](this['options'][_0xff090f(0x1e6)],_0x178b31),this['_heat']&&(this['_heat']['configure'](this['options']['heatStyle']),this['_updatePositionsHook'](!![]));}get['style'](){return this['options']['style'];}set[_0x5c0905(0x1f8)](_0x55a4ad){const _0x57adf1=_0x5c0905;this['options']['style']=mars3d__namespace['Util']['merge'](this[_0x57adf1(0x210)]['style'],_0x55a4ad);}get['positions'](){return this['_positions'];}set[_0x5c0905(0x213)](_0x2d0510){this['setPositions'](_0x2d0510);}get[_0x5c0905(0x20e)](){const _0x173558=_0x5c0905,_0x3aa49d=[];return this[_0x173558(0x1e9)]['forEach'](_0x23cb76=>{_0x3aa49d['push'](_0x23cb76['toArray']());}),_0x3aa49d;}get['rectangle'](){return this['_rectangle'];}['_setOptionsHook'](_0x2dd9eb,_0x2334ef){const _0x1c1840=_0x5c0905;_0x2dd9eb['positions']&&(this[_0x1c1840(0x213)]=_0x2dd9eb['positions']);}['_mountedHook'](){const _0x3856bf={_0x24f3fa:0x1ce,_0x3e7910:0x201,_0x5dc4e6:0x1e3,_0x30167e:0x1fe},_0x3d1ac1=_0x5c0905;this['style']['type']===_0x3d1ac1(_0x3856bf._0x24f3fa)?this['_layer']=new mars3d__namespace[(_0x3d1ac1(_0x3856bf._0x3e7910))][(_0x3d1ac1(_0x3856bf._0x5dc4e6))]({'crs':'EPSG:3857','private':!![]}):this[_0x3d1ac1(_0x3856bf._0x30167e)]=new mars3d__namespace['layer']['GraphicLayer']({'private':!![]});}['_addedHook'](){const _0x357dca={_0x458a68:0x1ee},_0x2bba52=_0x5c0905;this['_map'][_0x2bba52(_0x357dca._0x458a68)](this['_layer']),this['_container']=mars3d__namespace[_0x2bba52(0x20f)]['create']('div',_0x2bba52(0x1ea),this[_0x2bba52(0x1c8)]['container']),this['options']['positions']&&(this[_0x2bba52(0x213)]=this['options']['positions']),this[_0x2bba52(0x210)]['flyTo']&&this[_0x2bba52(0x1d6)]();}['_removedHook'](){const _0x3a4e39={_0x22d60d:0x1eb,_0x2e12da:0x1c8,_0x301ca0:0x1fe},_0x366612=_0x5c0905;this['_container']&&(mars3d__namespace['DomUtil']['remove'](this['_container']),delete this[_0x366612(_0x3a4e39._0x22d60d)]),this['clear'](),this[_0x366612(_0x3a4e39._0x2e12da)][_0x366612(0x1cc)](this[_0x366612(_0x3a4e39._0x301ca0)]);}['addPosition'](_0x170a50,_0x382244){const _0x473f95={_0xceada7:0x20a},_0x3f04fb=_0x5c0905;this['_positions']=this[_0x3f04fb(_0x473f95._0xceada7)]||[],this['_positions']['push'](_0x170a50),this['_updatePositionsHook'](_0x382244);}['setPositions'](_0xa742c9,_0x49d35a){const _0x32c5c3={_0x26e024:0x20a},_0x4ded1f=_0x5c0905;this[_0x4ded1f(_0x32c5c3._0x26e024)]=_0xa742c9,this[_0x4ded1f(0x1e7)](_0x49d35a);}[_0x5c0905(0x1ed)](){const _0x94c4b6={_0xeb3999:0x1e4,_0x5861d3:0x1e8},_0x1db987=_0x5c0905;this[_0x1db987(_0x94c4b6._0xeb3999)]&&(this['_layer']['removeGraphic'](this['_graphic'],!![]),delete this[_0x1db987(0x1e4)]),this['_graphic2']&&(this['_layer'][_0x1db987(_0x94c4b6._0x5861d3)](this['_graphic2'],!![]),delete this['_graphic2']);}[_0x5c0905(0x1e7)](_0x5ac43f){const _0x2c8853={_0x145e0f:0x213,_0x449535:0x1e4,_0x26499c:0x21d,_0x2b9189:0x215,_0x4990e2:0x1ce},_0x1fa0b3=_0x5c0905;if(!this['show']||!this['_map']||!this['positions']||this[_0x1fa0b3(_0x2c8853._0x145e0f)]['length']===0x0)return this;const _0x148840=this['_getHeatCanvas']();if(this['style']['type']===_0x1fa0b3(0x1ce))this['_layer']['setOptions']({'url':_0x148840['toDataURL']('image/png'),'rectangle':this['_rectangle'],'opacity':this[_0x1fa0b3(0x1f8)][_0x1fa0b3(0x20c)]});else this['style']['arc']?this['_graphic']&&_0x5ac43f?(this[_0x1fa0b3(_0x2c8853._0x449535)]['uniforms']['image']=_0x148840,this['_graphic']['uniforms'][_0x1fa0b3(0x215)]=this['_getArcHeatCanvas'](),this['_graphic2']&&(this['_graphic2'][_0x1fa0b3(_0x2c8853._0x26499c)][_0x1fa0b3(0x1ce)]=_0x148840,this['_graphic2']['uniforms'][_0x1fa0b3(_0x2c8853._0x2b9189)]=this['_graphic']['uniforms'][_0x1fa0b3(_0x2c8853._0x2b9189)])):this['_createArcGraphic'](_0x148840):this['_graphic']&&_0x5ac43f?this[_0x1fa0b3(_0x2c8853._0x449535)]['uniforms'][_0x1fa0b3(_0x2c8853._0x4990e2)]=_0x148840:this[_0x1fa0b3(0x206)](_0x148840);return this;}['_createGraphic'](_0x420f78){const _0x2f6f27={_0x28d03d:0x1fe},_0x33b544=_0x5c0905;this['clear'](),this['_graphic']=new mars3d__namespace['graphic'][(_0x33b544(0x21c))]({...this['options'],'rectangle':this[_0x33b544(0x1f5)],'appearance':new Cesium[(_0x33b544(0x1df))]({'material':new Cesium['Material']({'fabric':{'uniforms':{'image':_0x420f78},'source':HeatMaterial},'translucent':!![]}),'flat':!![]})}),this[_0x33b544(_0x2f6f27._0x28d03d)][_0x33b544(0x20d)](this['_graphic']);}['_createArcGraphic'](_0x2028d2){const _0x55789b={_0x353ff9:0x217,_0x700693:0x216,_0x37fa71:0x1ca,_0x211cde:0x1f8,_0x5120b4:0x209,_0x4c413f:0x1f5,_0x1ebcb9:0x1d0,_0x1ab126:0x1d1,_0x12b760:0x1df,_0x2e2579:0x1e4,_0x4c65d9:0x1f4,_0x2fbbf0:0x212},_0x1d2471=_0x5c0905;this[_0x1d2471(0x1ed)]();const _0x4d311f=Cesium['RenderState'][_0x1d2471(_0x55789b._0x353ff9)]({'cull':{'enabled':!![]},'depthTest':{'enabled':!![]},'stencilTest':{'enabled':!![],'frontFunction':Cesium['StencilFunction']['ALWAYS'],'frontOperation':{'fail':Cesium['StencilOperation']['KEEP'],'zFail':Cesium['StencilOperation'][_0x1d2471(_0x55789b._0x700693)],'zPass':Cesium['StencilOperation']['REPLACE']},'backFunction':Cesium['StencilFunction']['ALWAYS'],'backOperation':{'fail':Cesium['StencilOperation']['KEEP'],'zFail':Cesium['StencilOperation']['KEEP'],'zPass':Cesium['StencilOperation']['REPLACE']},'reference':0x2,'mask':0x2},'blending':Cesium[_0x1d2471(_0x55789b._0x37fa71)]['ALPHA_BLEND']}),_0x1c1103=Math[_0x1d2471(0x1fb)](this[_0x1d2471(_0x55789b._0x211cde)]['diffHeight']??this['_mBoundsMax']*0.02)+0.1;this['style']['diffHeight']&&delete this['style'][_0x1d2471(0x1cb)];const _0x1600aa=(this[_0x1d2471(0x1f8)][_0x1d2471(_0x55789b._0x5120b4)],0x64);let _0x137843=Math['max'](this['_rectangle']['height'],this[_0x1d2471(_0x55789b._0x4c413f)]['width']);this['style']['granularity']=_0x137843/=_0x1600aa;const _0xe6d995=new Cesium[(_0x1d2471(_0x55789b._0x1ebcb9))]({'fabric':{'uniforms':{'image':_0x2028d2,'repeat':new Cesium['Cartesian2'](0x1,0x1),'color':new Cesium['Color'](0x1,0x1,0x1,0x0),'bumpMap':this[_0x1d2471(_0x55789b._0x1ab126)]()},'source':HeatMaterial},'translucent':!![]}),_0x536bb7=this['style']['arcDirection']||0x1;this[_0x1d2471(0x1e4)]=new mars3d__namespace[(_0x1d2471(0x212))]['RectanglePrimitive']({...this[_0x1d2471(0x210)],'rectangle':this['_rectangle'],'appearance':new Cesium[(_0x1d2471(_0x55789b._0x12b760))]({'flat':!![],'aboveGround':!![],'renderState':_0x4d311f,'material':_0xe6d995,'vertexShaderSource':getVertexShaderSource(_0x1c1103*_0x536bb7)})}),this[_0x1d2471(0x1fe)]['addGraphic'](this[_0x1d2471(_0x55789b._0x2e2579)]),this['style']['arcDirection']===0x0&&(this[_0x1d2471(_0x55789b._0x4c65d9)]=new mars3d__namespace[(_0x1d2471(_0x55789b._0x2fbbf0))][(_0x1d2471(0x21c))]({...this['options'],'rectangle':this[_0x1d2471(0x1f5)],'appearance':new Cesium['EllipsoidSurfaceAppearance']({'flat':!![],'aboveGround':!![],'renderState':_0x4d311f,'material':_0xe6d995,'vertexShaderSource':getVertexShaderSource(-_0x1c1103)})}),this[_0x1d2471(0x1fe)]['addGraphic'](this['_graphic2']));}['getRectangle'](_0x5ea93f){const _0x249434={_0xa74188:0x1c9},_0x3f097c=_0x5c0905;return _0x5ea93f!==null&&_0x5ea93f!==void 0x0&&_0x5ea93f[_0x3f097c(0x1f0)]&&this['_rectangle']?mars3d__namespace[_0x3f097c(_0x249434._0xa74188)]['formatRectangle'](this['_rectangle']):this[_0x3f097c(0x1f5)];}['_getHeatCanvas'](){const _0x1fd8e7={_0x14649f:0x20a,_0x14bdf4:0x204,_0x3b2971:0x1fd,_0x53c947:0x1ec,_0x42f795:0x1d4,_0x13a1fe:0x207,_0x2c547a:0x1f5,_0x9e674d:0x204,_0x164989:0x1eb,_0x326c63:0x1f8},_0x3d258a={_0x3c9f9f:0x1fd,_0xfff963:0x202,_0x2c1e1e:0x1f9,_0x2682cb:0x1ec,_0x1c01c3:0x21a},_0xc67f1a={_0x5a8a6f:0x1f3,_0x24d180:0x1cf,_0x5ae1e6:0x20b,_0x5db4a2:0x21a},_0x11adac=_0x5c0905,_0x4abb1b=this[_0x11adac(_0x1fd8e7._0x14649f)],_0x4dd92b=[];let _0x4d39b8,_0x364b8a,_0x4d4146,_0x10ec5d;_0x4abb1b[_0x11adac(_0x1fd8e7._0x14bdf4)](_0x574fc7=>{const _0x5e0880=_0x11adac,_0x580efb=mars3d__namespace['LngLatPoint'][_0x5e0880(_0xc67f1a._0x5a8a6f)](_0x574fc7);if(!_0x580efb)return;_0x580efb['value']=_0x574fc7[_0x5e0880(0x1e5)]||0x1,!this['options'][_0x5e0880(0x1d9)]&&(_0x4d39b8===undefined?(_0x4d39b8=_0x580efb[_0x5e0880(_0xc67f1a._0x24d180)],_0x364b8a=_0x580efb['lng'],_0x4d4146=_0x580efb['lat'],_0x10ec5d=_0x580efb[_0x5e0880(_0xc67f1a._0x5ae1e6)]):(_0x4d39b8=Math['min'](_0x4d39b8,_0x580efb[_0x5e0880(0x1cf)]),_0x364b8a=Math[_0x5e0880(0x1ec)](_0x364b8a,_0x580efb['lng']),_0x4d4146=Math['min'](_0x4d4146,_0x580efb['lat']),_0x10ec5d=Math['max'](_0x10ec5d,_0x580efb[_0x5e0880(0x20b)]))),_0x4dd92b[_0x5e0880(_0xc67f1a._0x5db4a2)](_0x580efb);});_0x4d39b8===_0x364b8a&&(_0x4d39b8-=0.000001,_0x364b8a+=0.000001);_0x4d4146===_0x10ec5d&&(_0x4d4146-=0.000001,_0x10ec5d+=0.000001);let _0x3adabf=this['options']['rectangle']||{'xmin':_0x4d39b8,'xmax':_0x364b8a,'ymin':_0x4d4146,'ymax':_0x10ec5d};const _0x5e9f23=getMercatorBounds(_0x3adabf),_0x27eeaf=Math['abs'](_0x5e9f23[_0x11adac(0x207)]-_0x5e9f23[_0x11adac(_0x1fd8e7._0x3b2971)]),_0x5da09c=Math['abs'](_0x5e9f23['ymax']-_0x5e9f23[_0x11adac(0x1ef)]),_0x1dbe33=Math[_0x11adac(_0x1fd8e7._0x53c947)](_0x27eeaf,_0x5da09c),_0xceaa41=Math['min'](_0x27eeaf,_0x5da09c);this['_mBoundsMax']=_0x1dbe33;let _0x2205c9=0x1;if(_0x1dbe33>this['options']['maxCanvasSize'])_0x2205c9=_0x1dbe33/this[_0x11adac(0x210)]['maxCanvasSize'],_0xceaa41/_0x2205c9<this[_0x11adac(0x210)][_0x11adac(0x1f1)]&&(_0x2205c9=_0xceaa41/this['options'][_0x11adac(0x1f1)]);else _0xceaa41<this['options'][_0x11adac(0x1f1)]&&(_0x2205c9=_0xceaa41/this['options']['minCanvasSize'],_0x1dbe33/_0x2205c9>this['options'][_0x11adac(_0x1fd8e7._0x42f795)]&&(_0x2205c9=_0x1dbe33/this['options']['maxCanvasSize']));const _0x2a0e6b=this['heatStyle']['radius']*1.5,_0x334cf7=_0x27eeaf/_0x2205c9+_0x2a0e6b*0x2,_0x3968ab=_0x5da09c/_0x2205c9+_0x2a0e6b*0x2,_0x207b6f=_0x2a0e6b*_0x2205c9;_0x5e9f23[_0x11adac(0x1fd)]-=_0x207b6f,_0x5e9f23['ymin']-=_0x207b6f,_0x5e9f23[_0x11adac(_0x1fd8e7._0x13a1fe)]+=_0x207b6f,_0x5e9f23[_0x11adac(0x1f9)]+=_0x207b6f,this['_scale']=_0x2205c9,_0x3adabf=geLatLngBounds(_0x5e9f23),this[_0x11adac(_0x1fd8e7._0x2c547a)]=Cesium['Rectangle']['fromDegrees'](_0x3adabf['xmin'],_0x3adabf['ymin'],_0x3adabf['xmax'],_0x3adabf['ymax']);let _0x1fd229=_0x4dd92b[0x0]['value']??0x1,_0x4ad8be=_0x4dd92b[0x0]['value']??0x0;const _0x1ecc24=[];_0x4dd92b[_0x11adac(_0x1fd8e7._0x9e674d)](_0x112847=>{const _0x244508=_0x11adac,_0x405df7=mars3d__namespace['PointTrans']['lonlat2mercator']([_0x112847['lng'],_0x112847['lat']]),_0x17acfc=_0x112847['value']||0x1,_0x5e0ce9=Math['round']((_0x405df7[0x0]-_0x5e9f23[_0x244508(_0x3d258a._0x3c9f9f)])/_0x2205c9),_0x1f64a2=Math[_0x244508(_0x3d258a._0xfff963)]((_0x5e9f23[_0x244508(_0x3d258a._0x2c1e1e)]-_0x405df7[0x1])/_0x2205c9);_0x1fd229=Math[_0x244508(_0x3d258a._0x2682cb)](_0x1fd229,_0x17acfc),_0x4ad8be=Math['min'](_0x4ad8be,_0x17acfc),_0x1ecc24[_0x244508(_0x3d258a._0x1c01c3)]({'x':_0x5e0ce9,'y':_0x1f64a2,'value':_0x17acfc});});const _0x28589c={'min':this['options']['min']??_0x4ad8be,'max':this['options'][_0x11adac(_0x1fd8e7._0x53c947)]??_0x1fd229,'data':_0x1ecc24};this['_last_heatData']=_0x28589c;if(!this['_last_mBounds']||_0x5e9f23['xmin']!==this['_last_mBounds']['xmin']||_0x5e9f23['ymin']!==this[_0x11adac(0x1dd)][_0x11adac(0x1ef)]||_0x5e9f23['xmax']!==this['_last_mBounds']['xmax']||_0x5e9f23['ymax']!==this['_last_mBounds']['ymax']){this['_last_mBounds']=_0x5e9f23,this[_0x11adac(_0x1fd8e7._0x164989)][_0x11adac(_0x1fd8e7._0x326c63)]['cssText']='width:'+_0x334cf7+_0x11adac(0x1cd)+_0x3968ab+'px;';const _0x107d9c={...this[_0x11adac(0x1e6)],'container':this['_container']};!this['_heat']?this[_0x11adac(0x1fa)]=h337__namespace['create'](_0x107d9c):this['_heat']['configure'](_0x107d9c);}this['_heat']['setData'](_0x28589c);const _0x4a61ec=mars3d__namespace['DomUtil']['copyCanvas'](this['_heat']['_renderer']['canvas']);return _0x4a61ec;}['_getArcHeatCanvas'](){const _0x33debd={_0x46e103:0x1f8,_0x5a7c37:0x219,_0xa464c3:0x1db,_0x45f1c8:0x1d3,_0x51e3ad:0x210},_0x5569ec=_0x5c0905;this['_heat']['configure']({'radius':this[_0x5569ec(0x1e6)]['radius']*this[_0x5569ec(_0x33debd._0x46e103)]['arcRadiusScale'],'blur':this['heatStyle'][_0x5569ec(_0x33debd._0x5a7c37)]*this['style']['arcBlurScale'],'gradient':this[_0x5569ec(0x1e6)]['gradientArc']||{0.25:_0x5569ec(_0x33debd._0xa464c3),0.55:_0x5569ec(0x208),0.85:'rgb(216,216,216)',0x1:_0x5569ec(0x203)}});const _0x5f55ec=mars3d__namespace['DomUtil'][_0x5569ec(_0x33debd._0x45f1c8)](this['_heat']['_renderer']['canvas']);return this['_heat']['configure'](this[_0x5569ec(_0x33debd._0x51e3ad)]['heatStyle']),_0x5f55ec;}['getPointData'](_0x5e16c7){const _0x4c544d={_0x2e153b:0x202,_0x5ccbb8:0x1ff,_0x1b1d6b:0x1ff,_0xfd2524:0x1e1},_0x8df663=_0x5c0905,_0x2e0b13=mars3d__namespace['LngLatPoint'][_0x8df663(0x1f3)](_0x5e16c7);if(!_0x2e0b13)return{};const _0x3fe1a2=mars3d__namespace['PointTrans']['lonlat2mercator']([_0x2e0b13[_0x8df663(0x1cf)],_0x2e0b13[_0x8df663(0x20b)]]),_0x2a09f5=this['_last_mBounds'],_0x1a6fac=Math[_0x8df663(_0x4c544d._0x2e153b)]((_0x3fe1a2[0x0]-_0x2a09f5['xmin'])/this[_0x8df663(_0x4c544d._0x5ccbb8)]),_0x28f4b=Math['round']((_0x2a09f5[_0x8df663(0x1f9)]-_0x3fe1a2[0x1])/this[_0x8df663(_0x4c544d._0x1b1d6b)]),_0x251d0b=this['_heat']['getValueAt']({'x':_0x1a6fac,'y':_0x28f4b}),_0x51e0d2=this['_heat'][_0x8df663(_0x4c544d._0xfd2524)]['ctx'][_0x8df663(0x1e0)](_0x1a6fac-0x1,_0x28f4b-0x1,0x1,0x1)['data'];return{'x':_0x1a6fac,'y':_0x28f4b,'value':_0x251d0b,'color':'rgba('+_0x51e0d2[0x0]+','+_0x51e0d2[0x1]+','+_0x51e0d2[0x2]+','+_0x51e0d2[0x3]+')'};}}mars3d__namespace[_0x5c0905(0x1d5)]['register']('heat',HeatLayer),mars3d__namespace['layer'][_0x5c0905(0x1e2)]=HeatLayer,mars3d__namespace['h337']=h337__namespace;function _0xa96c(_0x11062d,_0x27f913){const _0x2edc09=_0x2edc();return _0xa96c=function(_0xa96c92,_0xd1901f){_0xa96c92=_0xa96c92-0x1c8;let _0x242488=_0x2edc09[_0xa96c92];return _0x242488;},_0xa96c(_0x11062d,_0x27f913);}function getMercatorBounds(_0xf96c24){const _0x3c72a8={_0x1b8c14:0x214,_0x563bd0:0x207},_0x44fe71=_0x5c0905,_0x794e1d=mars3d__namespace[_0x44fe71(_0x3c72a8._0x1b8c14)]['lonlat2mercator']([_0xf96c24['xmin'],_0xf96c24['ymin']]),_0x41ea11=mars3d__namespace['PointTrans']['lonlat2mercator']([_0xf96c24[_0x44fe71(_0x3c72a8._0x563bd0)],_0xf96c24[_0x44fe71(0x1f9)]]);return{'xmin':_0x794e1d[0x0],'ymin':_0x794e1d[0x1],'xmax':_0x41ea11[0x0],'ymax':_0x41ea11[0x1]};}function geLatLngBounds(_0x4f2a3e){const _0x57854c={_0x27edb7:0x1ef},_0x641327=_0x5c0905,_0x2f278c=mars3d__namespace['PointTrans']['mercator2lonlat']([_0x4f2a3e['xmin'],_0x4f2a3e[_0x641327(_0x57854c._0x27edb7)]]),_0x1c074d=mars3d__namespace['PointTrans']['mercator2lonlat']([_0x4f2a3e['xmax'],_0x4f2a3e['ymax']]);return{'xmin':_0x2f278c[0x0],'ymin':_0x2f278c[0x1],'xmax':_0x1c074d[0x0],'ymax':_0x1c074d[0x1]};}function getVertexShaderSource(_0x502985){return'in\x20vec3\x20position3DHigh;\x0a\x20\x20in\x20vec3\x20position3DLow;\x0a\x20\x20in\x20vec2\x20st;\x0a\x20\x20in\x20float\x20batchId;\x0a\x20\x20uniform\x20sampler2D\x20bumpMap_3;\x0a\x20\x20out\x20vec3\x20v_positionMC;\x0a\x20\x20out\x20vec3\x20v_positionEC;\x0a\x20\x20out\x20vec2\x20v_st;\x0a\x0a\x20\x20void\x20main()\x0a\x20\x20{\x0a\x20\x20\x20\x20vec4\x20p\x20=\x20czm_computePosition();\x0a\x20\x20\x20\x20v_positionMC\x20=\x20position3DHigh\x20+\x20position3DLow;\x0a\x20\x20\x20\x20v_positionEC\x20=\x20(czm_modelViewRelativeToEye\x20*\x20p).xyz;\x0a\x20\x20\x20\x20v_st\x20=\x20st;\x0a\x20\x20\x20\x20vec4\x20color\x20=\x20texture(bumpMap_3,\x20v_st);\x0a\x20\x20\x20\x20float\x20centerBump\x20=\x20distance(vec3(0.0),color.rgb);\x0a\x20\x20\x20\x20vec3\x20upDir\x20=\x20normalize(v_positionMC.xyz);\x0a\x20\x20\x20\x20vec3\x20disPos\x20=\x20upDir\x20*\x20centerBump\x20*\x20'+_0x502985+';\x0a\x20\x20\x20\x20p\x20+=vec4(disPos,0.0);\x0a\x20\x20\x20\x20gl_Position\x20=\x20czm_modelViewProjectionRelativeToEye\x20*\x20p;\x0a\x20\x20}\x0a';}exports['HeatLayer']=HeatLayer,Object['defineProperty'](exports,'__esModule',{'value':!![]});
}));
