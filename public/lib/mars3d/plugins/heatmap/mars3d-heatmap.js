/**
 * Mars3D平台插件,结合heatmap可视化功能插件  mars3d-heatmap
 *
 * 版本信息：v3.6.8
 * 编译日期：2023-10-08 23:31:33
 * 版权所有：Copyright by 火星科技  http://mars3d.cn
 * 使用单位：免费公开版 ，2023-03-17
 */
(function (global, factory) {
  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, (window.mars3d || require('mars3d')), (window.h337 || require('@mars3d/heatmap.js'))) :
  typeof define === 'function' && define.amd ? define(['exports', 'mars3d', '@mars3d/heatmap.js'], factory) :
  (global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory(global["mars3d-heatmap"] = {}, global.mars3d, global.h337));
})(this, (function (exports, mars3d, h337) { 
'use strict';const _0x5ce4fe=_0x625b;(function(_0x2b7608,_0x3cd89d){const _0x122b6c={_0x597b8b:0x18b,_0x247f79:0x191,_0x52f6c0:0x1bd,_0x562d79:0x195},_0x3a4e09=_0x625b,_0x10078c=_0x2b7608();while(!![]){try{const _0x5b6bba=parseInt(_0x3a4e09(_0x122b6c._0x597b8b))/0x1+parseInt(_0x3a4e09(0x196))/0x2+-parseInt(_0x3a4e09(0x1c1))/0x3*(parseInt(_0x3a4e09(0x1ad))/0x4)+-parseInt(_0x3a4e09(_0x122b6c._0x247f79))/0x5*(parseInt(_0x3a4e09(_0x122b6c._0x52f6c0))/0x6)+-parseInt(_0x3a4e09(0x1b9))/0x7+-parseInt(_0x3a4e09(_0x122b6c._0x562d79))/0x8+-parseInt(_0x3a4e09(0x1da))/0x9*(-parseInt(_0x3a4e09(0x1c0))/0xa);if(_0x5b6bba===_0x3cd89d)break;else _0x10078c['push'](_0x10078c['shift']());}catch(_0x1db0d8){_0x10078c['push'](_0x10078c['shift']());}}}(_0x5604,0xc3ad7));function _interopNamespace(_0x3ca3c8){const _0x354b59={_0x2e193f:0x18f},_0x4e4cf0={_0x50aa68:0x198},_0x557e7d=_0x625b;if(_0x3ca3c8&&_0x3ca3c8[_0x557e7d(0x18e)])return _0x3ca3c8;var _0x3cfdce=Object['create'](null);return _0x3ca3c8&&Object['keys'](_0x3ca3c8)[_0x557e7d(_0x354b59._0x2e193f)](function(_0x3d355b){const _0x85934e=_0x557e7d;if(_0x3d355b!=='default'){var _0x79ba4d=Object['getOwnPropertyDescriptor'](_0x3ca3c8,_0x3d355b);Object[_0x85934e(_0x4e4cf0._0x50aa68)](_0x3cfdce,_0x3d355b,_0x79ba4d['get']?_0x79ba4d:{'enumerable':!![],'get':function(){return _0x3ca3c8[_0x3d355b];}});}}),_0x3cfdce['default']=_0x3ca3c8,_0x3cfdce;}var mars3d__namespace=_interopNamespace(mars3d),h337__namespace=_interopNamespace(h337),HeatMaterial='uniform\x20sampler2D\x20image;\x0a\x0aczm_material\x20czm_getMaterial(czm_materialInput\x20materialInput)\x20{\x0a\x20\x20czm_material\x20material\x20=\x20czm_getDefaultMaterial(materialInput);\x0a\x20\x20vec2\x20st\x20=\x20materialInput.st;\x0a\x20\x20vec4\x20colorImage\x20=\x20texture(image,\x20st);\x0a\x20\x20if(colorImage.rgb\x20==\x20vec3(1.0)\x20||\x20colorImage.rgb\x20==\x20vec3(0.0))\x20{\x0a\x20\x20\x20\x20discard;\x0a\x20\x20}\x0a\x20\x20material.diffuse\x20=\x20colorImage.rgb;\x0a\x20\x20material.alpha\x20=\x20colorImage.a;\x0a\x20\x20return\x20material;\x0a}\x0a';if(!h337__namespace['create'])throw new Error('请引入\x20heatmap.js\x20库\x20');function _0x5604(){const _0x485a10=['mercator2lonlat','width:','StencilOperation','remove','px;','xmin','canvas','539624srjYDk','setOptions','radius','max','create','removeLayer','StencilFunction','_addedHook','formatRectangle','clear','setPositions','green','4314814ifqfYw','Rectangle','DomUtil','push','84IdFiAK','REPLACE','blur','10roknAy','24svkWjD','arcBlurScale','rectangle','ImageLayer','EPSG:3857','xmax','RenderState','heat','_map','_createArcGraphic','_updatePositionsHook','lonlat2mercator','abs','_last_mBounds','maxCanvasSize','floor','LayerUtil','ymin','_layer','ctx','rgb(140,140,140)','min','yellow','_graphic','lng','29075643gtvStc','minCanvasSize','clientHeight','layer','ymax','style','HeatLayer','diffHeight','addGraphic','_graphic2','red','value','options','rgb(255,255,255)','getRectangle','uniforms','copyCanvas','_heat','_scale','36628QUglKe','in\x20vec3\x20position3DHigh;\x0a\x20\x20in\x20vec3\x20position3DLow;\x0a\x20\x20in\x20vec2\x20st;\x0a\x20\x20in\x20float\x20batchId;\x0a\x20\x20uniform\x20sampler2D\x20bumpMap_3;\x0a\x20\x20out\x20vec3\x20v_positionMC;\x0a\x20\x20out\x20vec3\x20v_positionEC;\x0a\x20\x20out\x20vec2\x20v_st;\x0a\x0a\x20\x20void\x20main()\x0a\x20\x20{\x0a\x20\x20\x20\x20vec4\x20p\x20=\x20czm_computePosition();\x0a\x20\x20\x20\x20v_positionMC\x20=\x20position3DHigh\x20+\x20position3DLow;\x0a\x20\x20\x20\x20v_positionEC\x20=\x20(czm_modelViewRelativeToEye\x20*\x20p).xyz;\x0a\x20\x20\x20\x20v_st\x20=\x20st;\x0a\x20\x20\x20\x20vec4\x20color\x20=\x20texture(bumpMap_3,\x20v_st);\x0a\x20\x20\x20\x20float\x20centerBump\x20=\x20distance(vec3(0.0),color.rgb);\x0a\x20\x20\x20\x20vec3\x20upDir\x20=\x20normalize(v_positionMC.xyz);\x0a\x20\x20\x20\x20vec3\x20disPos\x20=\x20upDir\x20*\x20centerBump\x20*\x20','arcDirection','__esModule','forEach',';\x0a\x20\x20\x20\x20p\x20+=vec4(disPos,0.0);\x0a\x20\x20\x20\x20gl_Position\x20=\x20czm_modelViewProjectionRelativeToEye\x20*\x20p;\x0a\x20\x20}\x0a','15880tvUTRa','ALPHA_BLEND','Color','setData','7972744QFTPQv','541894aHADvo','PointTrans','defineProperty','removeGraphic','getImageData','positions','mars3d-heatmap\x20mars3d-hideDiv','_rectangle','_last_heatData','fromDegrees','_container','_getArcHeatCanvas','image','_positions','Material','configure'];_0x5604=function(){return _0x485a10;};return _0x5604();}const Cesium=mars3d__namespace['Cesium'],BaseLayer=mars3d__namespace[_0x5ce4fe(0x17b)]['BaseLayer'],DEF_HEATSTYLE={'maxOpacity':0.8,'minOpacity':0.1,'blur':0.85,'radius':0x19,'gradient':{0.4:'blue',0.6:_0x5ce4fe(0x1b8),0.8:_0x5ce4fe(0x1d7),0.9:_0x5ce4fe(0x182)}},DEF_STYLE={'arcRadiusScale':1.5,'arcBlurScale':1.5,'vertexFormat':Cesium['EllipsoidSurfaceAppearance']['VERTEX_FORMAT']};class HeatLayer extends BaseLayer{constructor(_0x3cd7a0={}){const _0x12cad1={_0x5dc3bc:0x1cf,_0x4b93df:0x1d6,_0x3c3525:0x184,_0x5ab37a:0x1db,_0x1d8ca7:0x17a},_0x21b553=_0x5ce4fe;super(_0x3cd7a0),this['options'][_0x21b553(0x1cf)]=this['options'][_0x21b553(_0x12cad1._0x5dc3bc)]??document['body']['clientWidth'],this[_0x21b553(0x184)]['maxCanvasSize']=Math[_0x21b553(_0x12cad1._0x4b93df)](this[_0x21b553(_0x12cad1._0x3c3525)]['maxCanvasSize'],0x1388),this[_0x21b553(_0x12cad1._0x3c3525)][_0x21b553(_0x12cad1._0x5ab37a)]=this['options']['minCanvasSize']??document['body'][_0x21b553(_0x12cad1._0x1d8ca7)],this['options']['minCanvasSize']=Math['max'](this['options']['minCanvasSize'],0x2bc),this['options']['heatStyle']={...DEF_HEATSTYLE,...this['options']['heatStyle']},this['options']['style']={...DEF_STYLE,...this['options'][_0x21b553(0x17d)]};}get['layer'](){const _0x573bd2={_0x4a8b64:0x1d3},_0x283cd7=_0x5ce4fe;return this[_0x283cd7(_0x573bd2._0x4a8b64)];}get['heatStyle'](){return this['options']['heatStyle'];}set['heatStyle'](_0x520f81){const _0x1b5435={_0x3c8951:0x189,_0x3b4afa:0x184},_0x496871=_0x5ce4fe;this['options']['heatStyle']=mars3d__namespace['Util']['merge'](this['options']['heatStyle'],_0x520f81),this['_heat']&&(this[_0x496871(_0x1b5435._0x3c8951)]['configure'](this[_0x496871(_0x1b5435._0x3b4afa)]['heatStyle']),this[_0x496871(0x1cb)](!![]));}get['style'](){const _0x414e6f=_0x5ce4fe;return this[_0x414e6f(0x184)]['style'];}set['style'](_0x5ab583){const _0x3f45e3=_0x5ce4fe;this['options']['style']=mars3d__namespace['Util']['merge'](this[_0x3f45e3(0x184)]['style'],_0x5ab583);}get['positions'](){return this['_positions'];}set['positions'](_0xad093b){const _0x22d5a8={_0xb35274:0x1b7},_0x4093d4=_0x5ce4fe;this[_0x4093d4(_0x22d5a8._0xb35274)](_0xad093b);}get['coordinates'](){const _0x573e07={_0x446d96:0x1bc},_0x5c0f57=[];return this['points']['forEach'](_0x4708af=>{const _0x28d57e=_0x625b;_0x5c0f57[_0x28d57e(_0x573e07._0x446d96)](_0x4708af['toArray']());}),_0x5c0f57;}get[_0x5ce4fe(0x1c3)](){const _0x47d1d5={_0x50e450:0x19d},_0x20830d=_0x5ce4fe;return this[_0x20830d(_0x47d1d5._0x50e450)];}['_setOptionsHook'](_0x5d2387,_0x2287af){_0x5d2387['positions']&&(this['positions']=_0x5d2387['positions']);}['_mountedHook'](){const _0x3ea0a7={_0x4292f5:0x1c4,_0x3c030a:0x1c5},_0x560437=_0x5ce4fe;this['style']['type']==='image'?this['_layer']=new mars3d__namespace['layer'][(_0x560437(_0x3ea0a7._0x4292f5))]({'crs':_0x560437(_0x3ea0a7._0x3c030a),'private':!![]}):this['_layer']=new mars3d__namespace['layer']['GraphicLayer']({'private':!![]});}[_0x5ce4fe(0x1b4)](){const _0x4c0737={_0x2653fc:0x1bb,_0x4caba7:0x19c},_0x25ac3f=_0x5ce4fe;this['_map']['addLayer'](this['_layer']),this['_container']=mars3d__namespace[_0x25ac3f(_0x4c0737._0x2653fc)]['create']('div',_0x25ac3f(_0x4c0737._0x4caba7),this[_0x25ac3f(0x1c9)]['container']),this['options']['positions']&&(this[_0x25ac3f(0x19b)]=this['options']['positions']),this['options']['flyTo']&&this['flyToByAnimationEnd']();}['_removedHook'](){const _0x315c23={_0x35cd22:0x1a9,_0x16a94f:0x1a0,_0x9ebfaa:0x1b6,_0x492071:0x1b2},_0xa61b44=_0x5ce4fe;this['_container']&&(mars3d__namespace['DomUtil'][_0xa61b44(_0x315c23._0x35cd22)](this['_container']),delete this[_0xa61b44(_0x315c23._0x16a94f)]),this[_0xa61b44(_0x315c23._0x9ebfaa)](),this['_map'][_0xa61b44(_0x315c23._0x492071)](this['_layer']);}['addPosition'](_0x28a9da,_0x248521){const _0x2f6d55={_0x199704:0x1cb},_0x428789=_0x5ce4fe;this['_positions']=this['_positions']||[],this[_0x428789(0x1a3)]['push'](_0x28a9da),this[_0x428789(_0x2f6d55._0x199704)](_0x248521);}['setPositions'](_0x503a47,_0xdb3268){const _0xf5b179={_0x5cca16:0x1a3},_0x3e371b=_0x5ce4fe;this[_0x3e371b(_0xf5b179._0x5cca16)]=_0x503a47,this['_updatePositionsHook'](_0xdb3268);}['clear'](){const _0x5a89a1={_0xba7297:0x1d8},_0x5a90b6=_0x5ce4fe;this[_0x5a90b6(_0x5a89a1._0xba7297)]&&(this['_layer'][_0x5a90b6(0x199)](this['_graphic'],!![]),delete this[_0x5a90b6(0x1d8)]),this[_0x5a90b6(0x181)]&&(this['_layer']['removeGraphic'](this['_graphic2'],!![]),delete this['_graphic2']);}['_updatePositionsHook'](_0x590fb7){const _0xb9432f={_0x57e81e:0x17d,_0x284530:0x1ae,_0x18646d:0x19d,_0x30b964:0x1a2,_0x52a6c1:0x181},_0x213faf=_0x5ce4fe;if(!this['show']||!this['_map']||!this['positions']||this['positions']['length']===0x0)return this;const _0x3c144d=this['_getHeatCanvas']();if(this[_0x213faf(_0xb9432f._0x57e81e)]['type']==='image')this[_0x213faf(0x1d3)][_0x213faf(_0xb9432f._0x284530)]({'url':_0x3c144d['toDataURL']('image/png'),'rectangle':this[_0x213faf(_0xb9432f._0x18646d)],'opacity':this['style']['opacity']});else this[_0x213faf(0x17d)]['arc']?this['_graphic']&&_0x590fb7?(this['_graphic']['uniforms'][_0x213faf(_0xb9432f._0x30b964)]=_0x3c144d,this['_graphic']['uniforms']['bumpMap']=this['_getArcHeatCanvas'](),this['_graphic2']&&(this[_0x213faf(_0xb9432f._0x52a6c1)]['uniforms'][_0x213faf(_0xb9432f._0x30b964)]=_0x3c144d,this[_0x213faf(0x181)][_0x213faf(0x187)]['bumpMap']=this['_graphic'][_0x213faf(0x187)]['bumpMap'])):this['_createArcGraphic'](_0x3c144d):this[_0x213faf(0x1d8)]&&_0x590fb7?this['_graphic']['uniforms']['image']=_0x3c144d:this['_createGraphic'](_0x3c144d);return this;}['_createGraphic'](_0x2630af){const _0x2d5369={_0x482964:0x1b6,_0x10639f:0x1d8,_0x7479ea:0x1a4,_0x432bd3:0x180},_0x3b768c=_0x5ce4fe;this[_0x3b768c(_0x2d5369._0x482964)](),this[_0x3b768c(_0x2d5369._0x10639f)]=new mars3d__namespace['graphic']['RectanglePrimitive']({...this['options'],'rectangle':this['_rectangle'],'appearance':new Cesium['EllipsoidSurfaceAppearance']({'material':new Cesium[(_0x3b768c(_0x2d5369._0x7479ea))]({'fabric':{'uniforms':{'image':_0x2630af},'source':HeatMaterial},'translucent':!![]}),'flat':!![]})}),this[_0x3b768c(0x1d3)][_0x3b768c(_0x2d5369._0x432bd3)](this['_graphic']);}[_0x5ce4fe(0x1ca)](_0x39dd7e){const _0x5b1533={_0x4f70ad:0x1b3,_0x3d4aa7:0x192,_0x5d4b94:0x1d0,_0xedc54:0x17f,_0x2f95b2:0x193,_0x190e55:0x18d,_0x55cda5:0x19d},_0x2f9d52=_0x5ce4fe;this['clear']();const _0x440b61=Cesium[_0x2f9d52(0x1c7)]['fromCache']({'cull':{'enabled':!![]},'depthTest':{'enabled':!![]},'stencilTest':{'enabled':!![],'frontFunction':Cesium['StencilFunction']['ALWAYS'],'frontOperation':{'fail':Cesium[_0x2f9d52(0x1a8)]['KEEP'],'zFail':Cesium['StencilOperation']['KEEP'],'zPass':Cesium['StencilOperation'][_0x2f9d52(0x1be)]},'backFunction':Cesium[_0x2f9d52(_0x5b1533._0x4f70ad)]['ALWAYS'],'backOperation':{'fail':Cesium['StencilOperation']['KEEP'],'zFail':Cesium['StencilOperation']['KEEP'],'zPass':Cesium['StencilOperation']['REPLACE']},'reference':0x2,'mask':0x2},'blending':Cesium['BlendingState'][_0x2f9d52(_0x5b1533._0x3d4aa7)]}),_0x4bebc4=Math[_0x2f9d52(_0x5b1533._0x5d4b94)](this['style'][_0x2f9d52(0x17f)]??this['_mBoundsMax']*0.02)+0.1;this[_0x2f9d52(0x17d)]['diffHeight']&&delete this['style'][_0x2f9d52(_0x5b1533._0xedc54)];const _0x513f70=(this[_0x2f9d52(0x17d)]['splitNum'],0x64);let _0x591ebf=Math[_0x2f9d52(0x1b0)](this[_0x2f9d52(0x19d)]['height'],this['_rectangle']['width']);this['style']['granularity']=_0x591ebf/=_0x513f70;const _0x313e78=new Cesium['Material']({'fabric':{'uniforms':{'image':_0x39dd7e,'repeat':new Cesium['Cartesian2'](0x1,0x1),'color':new Cesium[(_0x2f9d52(_0x5b1533._0x2f95b2))](0x1,0x1,0x1,0x0),'bumpMap':this[_0x2f9d52(0x1a1)]()},'source':HeatMaterial},'translucent':!![]}),_0x2bd9ba=this[_0x2f9d52(0x17d)]['arcDirection']||0x1;this['_graphic']=new mars3d__namespace['graphic']['RectanglePrimitive']({...this['options'],'rectangle':this[_0x2f9d52(0x19d)],'appearance':new Cesium['EllipsoidSurfaceAppearance']({'flat':!![],'aboveGround':!![],'renderState':_0x440b61,'material':_0x313e78,'vertexShaderSource':getVertexShaderSource(_0x4bebc4*_0x2bd9ba)})}),this['_layer'][_0x2f9d52(0x180)](this['_graphic']),this['style'][_0x2f9d52(_0x5b1533._0x190e55)]===0x0&&(this['_graphic2']=new mars3d__namespace['graphic']['RectanglePrimitive']({...this['options'],'rectangle':this[_0x2f9d52(_0x5b1533._0x55cda5)],'appearance':new Cesium['EllipsoidSurfaceAppearance']({'flat':!![],'aboveGround':!![],'renderState':_0x440b61,'material':_0x313e78,'vertexShaderSource':getVertexShaderSource(-_0x4bebc4)})}),this[_0x2f9d52(0x1d3)]['addGraphic'](this['_graphic2']));}[_0x5ce4fe(0x186)](_0xfd0227){const _0x313da4=_0x5ce4fe;return _0xfd0227!==null&&_0xfd0227!==void 0x0&&_0xfd0227['isFormat']&&this['_rectangle']?mars3d__namespace['PolyUtil'][_0x313da4(0x1b5)](this['_rectangle']):this['_rectangle'];}['_getHeatCanvas'](){const _0x47354d={_0x4b1aa3:0x1b0,_0x803230:0x1db,_0x2e7fe3:0x184,_0x3a5190:0x1af,_0x533e77:0x1d2,_0x34d288:0x17c,_0x12e5d7:0x18a,_0x2a1824:0x1ba,_0x41a42a:0x19f,_0x3ed5cc:0x17c,_0x4a8fb3:0x183,_0x48ff0c:0x1ce,_0x2877ec:0x1ce,_0x49b8e5:0x1a7,_0x4d0ba0:0x189,_0x181fa0:0x189,_0x9c439a:0x194,_0x3ed5e7:0x188},_0x540e44={_0x23f355:0x1d9,_0xc1b5fe:0x1ab},_0x5d8318={_0xdbec74:0x183,_0x28e48f:0x1d9},_0x305c37=_0x5ce4fe,_0x44064f=this[_0x305c37(0x1a3)],_0x40fa69=[];let _0x28680f,_0x400fdb,_0xc486c2,_0x206fe4;_0x44064f['forEach'](_0x27a6c2=>{const _0x39eebc=_0x305c37,_0x42d4a5=mars3d__namespace['LngLatPoint']['parse'](_0x27a6c2);if(!_0x42d4a5)return;_0x42d4a5[_0x39eebc(_0x5d8318._0xdbec74)]=_0x27a6c2['value']||0x1,!this['options']['rectangle']&&(_0x28680f===undefined?(_0x28680f=_0x42d4a5['lng'],_0x400fdb=_0x42d4a5[_0x39eebc(0x1d9)],_0xc486c2=_0x42d4a5['lat'],_0x206fe4=_0x42d4a5['lat']):(_0x28680f=Math['min'](_0x28680f,_0x42d4a5['lng']),_0x400fdb=Math['max'](_0x400fdb,_0x42d4a5[_0x39eebc(_0x5d8318._0x28e48f)]),_0xc486c2=Math['min'](_0xc486c2,_0x42d4a5['lat']),_0x206fe4=Math[_0x39eebc(0x1b0)](_0x206fe4,_0x42d4a5['lat']))),_0x40fa69['push'](_0x42d4a5);});_0x28680f===_0x400fdb&&(_0x28680f-=0.000001,_0x400fdb+=0.000001);_0xc486c2===_0x206fe4&&(_0xc486c2-=0.000001,_0x206fe4+=0.000001);let _0x360afc=this['options']['rectangle']||{'xmin':_0x28680f,'xmax':_0x400fdb,'ymin':_0xc486c2,'ymax':_0x206fe4};const _0x43c2ae=getMercatorBounds(_0x360afc),_0x3b40a4=Math['abs'](_0x43c2ae['xmax']-_0x43c2ae['xmin']),_0x3c725d=Math[_0x305c37(0x1cd)](_0x43c2ae['ymax']-_0x43c2ae['ymin']),_0x55e44a=Math[_0x305c37(_0x47354d._0x4b1aa3)](_0x3b40a4,_0x3c725d),_0x238e81=Math['min'](_0x3b40a4,_0x3c725d);this['_mBoundsMax']=_0x55e44a;let _0x270ceb=0x1;if(_0x55e44a>this['options']['maxCanvasSize'])_0x270ceb=_0x55e44a/this['options']['maxCanvasSize'],_0x238e81/_0x270ceb<this['options'][_0x305c37(_0x47354d._0x803230)]&&(_0x270ceb=_0x238e81/this[_0x305c37(_0x47354d._0x2e7fe3)]['minCanvasSize']);else _0x238e81<this['options']['minCanvasSize']&&(_0x270ceb=_0x238e81/this['options']['minCanvasSize'],_0x55e44a/_0x270ceb>this['options']['maxCanvasSize']&&(_0x270ceb=_0x55e44a/this['options']['maxCanvasSize']));const _0x72f5da=this['heatStyle'][_0x305c37(_0x47354d._0x3a5190)]*1.5,_0x14ffd0=_0x3b40a4/_0x270ceb+_0x72f5da*0x2,_0x19782f=_0x3c725d/_0x270ceb+_0x72f5da*0x2,_0x44e4d8=_0x72f5da*_0x270ceb;_0x43c2ae['xmin']-=_0x44e4d8,_0x43c2ae[_0x305c37(_0x47354d._0x533e77)]-=_0x44e4d8,_0x43c2ae['xmax']+=_0x44e4d8,_0x43c2ae[_0x305c37(_0x47354d._0x34d288)]+=_0x44e4d8,this[_0x305c37(_0x47354d._0x12e5d7)]=_0x270ceb,_0x360afc=geLatLngBounds(_0x43c2ae),this['_rectangle']=Cesium[_0x305c37(_0x47354d._0x2a1824)][_0x305c37(_0x47354d._0x41a42a)](_0x360afc['xmin'],_0x360afc['ymin'],_0x360afc['xmax'],_0x360afc[_0x305c37(_0x47354d._0x3ed5cc)]);let _0x1a89dc=_0x40fa69[0x0]['value']??0x1,_0x159ef8=_0x40fa69[0x0][_0x305c37(_0x47354d._0x4a8fb3)]??0x0;const _0x12ee16=[];_0x40fa69['forEach'](_0x17947a=>{const _0x15d320=_0x305c37,_0x58a062=mars3d__namespace['PointTrans']['lonlat2mercator']([_0x17947a[_0x15d320(_0x540e44._0x23f355)],_0x17947a['lat']]),_0x4e4cae=_0x17947a['value']||0x1,_0x1122ed=Math['round']((_0x58a062[0x0]-_0x43c2ae[_0x15d320(_0x540e44._0xc1b5fe)])/_0x270ceb),_0x320478=Math['round']((_0x43c2ae['ymax']-_0x58a062[0x1])/_0x270ceb);_0x1a89dc=Math['max'](_0x1a89dc,_0x4e4cae),_0x159ef8=Math['min'](_0x159ef8,_0x4e4cae),_0x12ee16['push']({'x':_0x1122ed,'y':_0x320478,'value':_0x4e4cae});});const _0x24a0b3={'min':this['options']['min']??_0x159ef8,'max':this['options']['max']??_0x1a89dc,'data':_0x12ee16};this[_0x305c37(0x19e)]=_0x24a0b3;if(!this['_last_mBounds']||_0x43c2ae[_0x305c37(0x1ab)]!==this[_0x305c37(_0x47354d._0x48ff0c)][_0x305c37(0x1ab)]||_0x43c2ae['ymin']!==this['_last_mBounds']['ymin']||_0x43c2ae['xmax']!==this[_0x305c37(_0x47354d._0x48ff0c)]['xmax']||_0x43c2ae['ymax']!==this['_last_mBounds']['ymax']){this[_0x305c37(_0x47354d._0x2877ec)]=_0x43c2ae,this['_container']['style']['cssText']=_0x305c37(_0x47354d._0x49b8e5)+_0x14ffd0+'px;height:'+_0x19782f+_0x305c37(0x1aa);const _0x6d570a={...this['heatStyle'],'container':this['_container']};!this[_0x305c37(_0x47354d._0x4d0ba0)]?this['_heat']=h337__namespace[_0x305c37(0x1b1)](_0x6d570a):this[_0x305c37(_0x47354d._0x181fa0)][_0x305c37(0x1a5)](_0x6d570a);}this['_heat'][_0x305c37(_0x47354d._0x9c439a)](_0x24a0b3);const _0x3626e5=mars3d__namespace[_0x305c37(0x1bb)][_0x305c37(_0x47354d._0x3ed5e7)](this['_heat']['_renderer'][_0x305c37(0x1ac)]);return _0x3626e5;}['_getArcHeatCanvas'](){const _0x407875={_0x2685d0:0x1bf,_0x5a54b8:0x1c2,_0x50781a:0x1ac,_0x2bc085:0x1a5},_0x7e27d9=_0x5ce4fe;this[_0x7e27d9(0x189)]['configure']({'radius':this['heatStyle']['radius']*this['style']['arcRadiusScale'],'blur':this['heatStyle'][_0x7e27d9(_0x407875._0x2685d0)]*this[_0x7e27d9(0x17d)][_0x7e27d9(_0x407875._0x5a54b8)],'gradient':this['heatStyle']['gradientArc']||{0.25:'rgb(0,0,0)',0.55:_0x7e27d9(0x1d5),0.85:'rgb(216,216,216)',0x1:_0x7e27d9(0x185)}});const _0x13cd41=mars3d__namespace['DomUtil']['copyCanvas'](this[_0x7e27d9(0x189)]['_renderer'][_0x7e27d9(_0x407875._0x50781a)]);return this['_heat'][_0x7e27d9(_0x407875._0x2bc085)](this['options']['heatStyle']),_0x13cd41;}['getPointData'](_0x3eb1e9){const _0x820968={_0x336c4f:0x17c,_0x57cdc4:0x189},_0x4163c8=_0x5ce4fe,_0x1734b6=mars3d__namespace['LngLatPoint']['parse'](_0x3eb1e9);if(!_0x1734b6)return{};const _0x3c7040=mars3d__namespace[_0x4163c8(0x197)][_0x4163c8(0x1cc)]([_0x1734b6['lng'],_0x1734b6['lat']]),_0x368b67=this['_last_mBounds'],_0xa6dc91=Math['round']((_0x3c7040[0x0]-_0x368b67['xmin'])/this['_scale']),_0x3735ab=Math['round']((_0x368b67[_0x4163c8(_0x820968._0x336c4f)]-_0x3c7040[0x1])/this['_scale']),_0x1dc514=this[_0x4163c8(_0x820968._0x57cdc4)]['getValueAt']({'x':_0xa6dc91,'y':_0x3735ab}),_0x182240=this['_heat']['_renderer'][_0x4163c8(0x1d4)][_0x4163c8(0x19a)](_0xa6dc91-0x1,_0x3735ab-0x1,0x1,0x1)['data'];return{'x':_0xa6dc91,'y':_0x3735ab,'value':_0x1dc514,'color':'rgba('+_0x182240[0x0]+','+_0x182240[0x1]+','+_0x182240[0x2]+','+_0x182240[0x3]+')'};}}mars3d__namespace[_0x5ce4fe(0x1d1)]['register'](_0x5ce4fe(0x1c8),HeatLayer),mars3d__namespace['layer']['HeatLayer']=HeatLayer,mars3d__namespace['h337']=h337__namespace;function getMercatorBounds(_0x555c88){const _0x2d5875={_0x449b3c:0x1ab},_0x3ac2a9=_0x5ce4fe,_0x16cd54=mars3d__namespace['PointTrans']['lonlat2mercator']([_0x555c88[_0x3ac2a9(_0x2d5875._0x449b3c)],_0x555c88[_0x3ac2a9(0x1d2)]]),_0x253b55=mars3d__namespace['PointTrans']['lonlat2mercator']([_0x555c88[_0x3ac2a9(0x1c6)],_0x555c88['ymax']]);return{'xmin':_0x16cd54[0x0],'ymin':_0x16cd54[0x1],'xmax':_0x253b55[0x0],'ymax':_0x253b55[0x1]};}function _0x625b(_0x31102c,_0x43fbbe){const _0x56048d=_0x5604();return _0x625b=function(_0x625bc8,_0x522853){_0x625bc8=_0x625bc8-0x17a;let _0x194dac=_0x56048d[_0x625bc8];return _0x194dac;},_0x625b(_0x31102c,_0x43fbbe);}function geLatLngBounds(_0xd967b8){const _0x20059e={_0x4b4071:0x1a6,_0x45fbb2:0x1c6},_0x12b638=_0x5ce4fe,_0x28cbd6=mars3d__namespace[_0x12b638(0x197)][_0x12b638(_0x20059e._0x4b4071)]([_0xd967b8['xmin'],_0xd967b8['ymin']]),_0x50eaf0=mars3d__namespace['PointTrans']['mercator2lonlat']([_0xd967b8[_0x12b638(_0x20059e._0x45fbb2)],_0xd967b8['ymax']]);return{'xmin':_0x28cbd6[0x0],'ymin':_0x28cbd6[0x1],'xmax':_0x50eaf0[0x0],'ymax':_0x50eaf0[0x1]};}function getVertexShaderSource(_0x4e058d){const _0x1603d7={_0x3f943b:0x18c,_0x10ebcd:0x190},_0x3a7da7=_0x5ce4fe;return _0x3a7da7(_0x1603d7._0x3f943b)+_0x4e058d+_0x3a7da7(_0x1603d7._0x10ebcd);}exports[_0x5ce4fe(0x17e)]=HeatLayer,Object[_0x5ce4fe(0x198)](exports,'__esModule',{'value':!![]});
}));
